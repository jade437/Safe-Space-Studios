<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EmpowerVault - Secure Document Storage</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6C63FF;
            --primary-light: #a29bfe;
            --primary-dark: #483dff;
            --secondary: #FF6584;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-shadow: 0 10px 20px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f5f7ff;
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Consent Modal Styles */
        .consent-modal {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }

        .consent-content {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.5s ease;
        }

        .consent-header {
            background: var(--bg-gradient);
            color: white;
            padding: 2rem;
            border-radius: 20px 20px 0 0;
            text-align: center;
        }

        .consent-header h2 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .consent-header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .consent-body {
            padding: 2rem;
        }

        .consent-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--light);
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }

        .consent-section h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .consent-options {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .consent-option {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--light-gray);
            transition: var(--transition);
        }

        .consent-option:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(108, 99, 255, 0.1);
        }

        .consent-option input[type="checkbox"] {
            margin-top: 0.2rem;
            transform: scale(1.2);
        }

        .consent-label {
            flex: 1;
        }

        .consent-label h4 {
            color: var(--dark);
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .consent-label p {
            color: var(--gray);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .required-badge {
            background: var(--primary);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .optional-badge {
            background: var(--gray);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .consent-footer {
            padding: 1.5rem 2rem;
            background: var(--light);
            border-radius: 0 0 20px 20px;
            border-top: 1px solid var(--light-gray);
        }

        .consent-actions {
            display: flex;
            gap: 1rem;
            justify-content: space-between;
            align-items: center;
        }

        .consent-details {
            flex: 1;
        }

        .consent-details p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .consent-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn-consent {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            min-width: 120px;
        }

        .btn-consent-primary {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }

        .btn-consent-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
        }

        .btn-consent-secondary {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-consent-secondary:hover {
            background-color: var(--primary-light);
            color: white;
        }

        .btn-consent:disabled {
            background-color: var(--light-gray);
            color: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Language Selector */
        .language-selector {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
        }

        .language-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
        }

        .language-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 200px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            margin-top: 0.5rem;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--dark);
        }

        .language-option:hover {
            background: var(--primary-light);
            color: white;
        }

        .language-flag {
            width: 20px;
            height: 15px;
            border-radius: 2px;
            object-fit: cover;
        }

        /* Vibrant header with gradient */
        .app-header {
            background: var(--bg-gradient);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--card-shadow);
            position: relative;
            z-index: 100;
        }

        .app-header h1 {
            font-size: 1.8rem;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Privacy Settings in Header */
        .privacy-settings {
            position: relative;
        }

        .privacy-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            width: 250px;
            display: none;
            z-index: 1000;
            margin-top: 0.5rem;
        }

        .privacy-menu.show {
            display: block;
        }

        .privacy-option {
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.8rem;
            color: var(--dark);
            border-bottom: 1px solid var(--light-gray);
        }

        .privacy-option:last-child {
            border-bottom: none;
        }

        .privacy-option:hover {
            background: var(--primary-light);
            color: white;
        }

        /* Consent Status Indicator */
        .consent-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(76, 175, 80, 0.1);
            border-radius: 20px;
            color: var(--success);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .consent-status.revoked {
            background: rgba(244, 67, 54, 0.1);
            color: var(--danger);
        }

        /* Animated menu toggle */
        .menu-toggle {
            background: transparent;
            border: none;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            height: 24px;
            width: 30px;
            padding: 0;
            position: relative;
            z-index: 10;
        }

        .menu-toggle span {
            display: block;
            height: 3px;
            width: 100%;
            background: white;
            border-radius: 3px;
            transition: var(--transition);
            transform-origin: center;
        }

        .menu-toggle:hover span {
            background: var(--primary-light);
        }

        .menu-toggle.active span:nth-child(1) {
            transform: translateY(10px) rotate(45deg);
        }

        .menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }

        .menu-toggle.active span:nth-child(3) {
            transform: translateY(-10px) rotate(-45deg);
        }

        /* Emergency exit button with pulse animation */
        .emergency-exit {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .btn-emergency {
            background-color: var(--danger);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.4);
            transition: var(--transition);
            animation: pulse 2s infinite;
        }

        .btn-emergency:hover {
            background-color: #e53935;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(244, 67, 54, 0.6);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Main vault container with animated cards */
        .vault-container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .vault-header {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }

        .vault-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary);
        }

        .vault-header h2 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            color: var(--primary-dark);
        }

        .vault-description {
            color: var(--gray);
            margin-bottom: 1.5rem;
        }

        /* Enhanced Security Notice */
        .security-notice {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .security-notice i {
            font-size: 2rem;
        }

        .security-notice-content h3 {
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .security-notice-content p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        /* Data Usage Transparency Section */
        .data-usage {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
        }

        .data-usage h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .usage-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .usage-item:last-child {
            border-bottom: none;
        }

        .usage-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .usage-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(108, 99, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        .usage-details h4 {
            font-size: 1rem;
            margin-bottom: 0.2rem;
            color: var(--dark);
        }

        .usage-details p {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .usage-status {
            font-size: 0.8rem;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-weight: 500;
        }

        .status-active {
            background: rgba(76, 175, 80, 0.1);
            color: var(--success);
        }

        .status-inactive {
            background: rgba(108, 117, 125, 0.1);
            color: var(--gray);
        }

        /* Interactive action buttons */
        .vault-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn-primary, .btn-secondary {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            border: none;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
        }

        .btn-secondary {
            background-color: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-secondary:hover {
            background-color: var(--primary-light);
            color: white;
            transform: translateY(-2px);
        }

        /* Voice-to-text button */
        .btn-voice {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
        }

        .btn-voice:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .btn-voice.recording {
            background-color: var(--danger);
            animation: pulse 1.5s infinite;
        }

        /* Animated search bar */
        .vault-search {
            position: relative;
            flex-grow: 1;
            min-width: 250px;
        }

        .vault-search input {
            width: 100%;
            padding: 0.8rem 1.5rem 0.8rem 3rem;
            border-radius: 8px;
            border: 1px solid var(--light-gray);
            font-size: 1rem;
            transition: var(--transition);
        }

        .vault-search input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }

        .search-btn {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            color: var(--gray);
            cursor: pointer;
            transition: var(--transition);
        }

        .vault-search:focus-within .search-btn {
            color: var(--primary);
        }

        /* Vault content layout */
        .vault-content {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .vault-sidebar {
            flex: 1;
            min-width: 280px;
        }

        .vault-items {
            flex: 3;
            min-width: 300px;
        }

        /* Interactive sidebar components */
        .vault-categories, .vault-tags, .vault-stats {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: var(--card-shadow);
        }

        .vault-categories h3, .vault-tags h3, .vault-stats h3 {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .vault-categories ul {
            list-style: none;
        }

        .vault-categories li {
            padding: 0.8rem 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            transition: var(--transition);
        }

        .vault-categories li:hover {
            background-color: var(--primary-light);
            color: white;
            transform: translateX(5px);
        }

        .vault-categories li.active {
            background-color: var(--primary);
            color: white;
            font-weight: 500;
        }

        .vault-categories li i {
            width: 20px;
            text-align: center;
        }

        /* Tag cloud with hover effects */
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag {
            background-color: var(--light);
            color: var(--dark);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .tag:hover {
            background-color: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(108, 99, 255, 0.2);
        }

        /* Stats with animated numbers */
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--gray);
        }

        .stat-value {
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1rem;
        }

        /* Interactive vault items */
        .vault-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .vault-item {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .vault-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }

        .vault-item::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--primary);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s ease;
        }

        .vault-item:hover::after {
            transform: scaleX(1);
        }

        .item-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(108, 99, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.5rem;
            color: var(--primary);
            transition: var(--transition);
        }

        .vault-item:hover .item-icon {
            background: var(--primary);
            color: white;
            transform: rotate(15deg) scale(1.1);
        }

        .item-details h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .item-meta {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .item-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }

        .item-tags .tag {
            font-size: 0.8rem;
            padding: 0.3rem 0.8rem;
        }

        .item-actions {
            margin-top: auto;
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--light);
            color: var(--gray);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-icon:hover {
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        .play-audio:hover {
            background: var(--success) !important;
        }

        /* Modal styles with animations */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.4s ease;
            position: relative;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-content h2 {
            color: var(--primary-dark);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .upload-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .upload-option {
            background: white;
            border: 2px dashed var(--light-gray);
            border-radius: 12px;
            padding: 1.5rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-option:hover {
            border-color: var(--primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.1);
        }

        .upload-option i {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
            transition: var(--transition);
        }

        .upload-option:hover i {
            transform: scale(1.2);
            color: var(--primary-dark);
        }

        .upload-option h3 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .upload-option p {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Security options with toggle switches */
        .upload-security {
            margin-bottom: 2rem;
        }

        .upload-security h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--dark);
        }

        .security-option {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }

        .security-option input[type="checkbox"] {
            display: none;
        }

        .security-option label {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            cursor: pointer;
            color: var(--dark);
            font-size: 0.95rem;
            position: relative;
            padding-left: 50px;
        }

        .security-option label i {
            color: var(--primary);
            width: 20px;
        }

        .security-option label::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 20px;
            background: var(--light-gray);
            border-radius: 10px;
            transition: var(--transition);
        }

        .security-option label::after {
            content: '';
            position: absolute;
            left: 2px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: white;
            border-radius: 50%;
            transition: var(--transition);
        }

        .security-option input:checked + label::before {
            background: var(--primary);
        }

        .security-option input:checked + label::after {
            left: 22px;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Journal entry styles with voice-to-text */
        .journal-entry {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        .journal-entry h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem;
        }

        .journal-content {
            min-height: 200px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            padding: 1rem;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1rem;
            position: relative;
        }

        .voice-controls {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .transcript-preview {
            background: var(--light);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 4px solid var(--primary);
            display: none;
        }

        .transcript-preview.show {
            display: block;
        }

        .transcript-text {
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 0.5rem;
        }

        .transcript-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .journal-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        /* Voice recording styles */
        .audio-recorder {
            margin-bottom: 1.5rem;
        }

        .audio-visualizer {
            width: 100%;
            height: 150px;
            background: var(--light);
            border-radius: 12px;
            margin-bottom: 1rem;
            position: relative;
            overflow: hidden;
        }

        #visualizer {
            width: 100%;
            height: 100%;
        }

        .audio-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }

        .audio-controls button {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
        }

        #start-recording {
            background: var(--danger);
            color: white;
        }

        #stop-recording {
            background: var(--gray);
            color: white;
        }

        #play-recording {
            background: var(--success);
            color: white;
        }

        .recording-timer {
            text-align: center;
            margin-top: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
        }

        /* Form groups for audio metadata */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--light-gray);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }

        /* AI Chatbot styles */
        .ai-chatbot-container {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            transition: transform 0.3s ease;
            transform-origin: bottom right;
        }

        .ai-chatbot-header {
            padding: 1rem 1.5rem;
            background: var(--bg-gradient);
            color: white;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-chatbot-header h3 {
            font-size: 1.1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .ai-chatbot-messages {
            flex: 1;
            padding: 1.5rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .ai-message {
            max-width: 80%;
            padding: 0.8rem 1rem;
            border-radius: 12px;
            animation: fadeIn 0.3s ease;
        }

        .user-message {
            align-self: flex-end;
            background: var(--primary);
            color: white;
            border-radius: 12px 12px 0 12px;
        }

        .ai-response {
            align-self: flex-start;
            background: var(--light);
            color: var(--dark);
            border-radius: 12px 12px 12px 0;
        }

        .message-content p {
            font-size: 0.95rem;
        }

        .ai-chatbot-input {
            padding: 1rem;
            border-top: 1px solid var(--light-gray);
        }

        .ai-chatbot-input textarea {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--light-gray);
            resize: none;
            font-size: 0.95rem;
            min-height: 50px;
            max-height: 100px;
            margin-bottom: 0.5rem;
            transition: var(--transition);
        }

        .ai-chatbot-input textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }

        .chat-controls {
            display: flex;
            gap: 0.5rem;
        }

        .ai-chatbot-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 5px 15px rgba(108, 99, 255, 0.4);
            transition: var(--transition);
            z-index: 1001;
        }

        .ai-chatbot-toggle:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        /* Typing indicator */
        .typing-indicator {
            display: flex;
            gap: 0.3rem;
            padding: 0.8rem 1rem;
            background: var(--light);
            border-radius: 12px;
            align-self: flex-start;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--gray);
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        /* Upload progress bar */
        .upload-progress {
            margin-top: 1rem;
            display: none;
        }

        .progress-bar {
            height: 8px;
            background: var(--light-gray);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.85rem;
            color: var(--gray);
            text-align: center;
        }

        /* Voice recording styles */
        .recording-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--danger);
            color: white;
            border-radius: 20px;
            margin-bottom: 1rem;
            animation: pulse 1.5s infinite;
        }

        .recording-indicator i {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Audio player styles */
        .audio-player {
            width: 100%;
            margin: 1rem 0;
        }

        .audio-player audio {
            width: 100%;
        }

        /* Voice Navigation Styles */
        .voice-navigation {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1000;
        }

        .voice-control {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
            transition: var(--transition);
            position: relative;
        }

        .voice-control:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .voice-control.listening {
            background: var(--danger);
            animation: pulse 1.5s infinite;
        }

        .voice-feedback {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            margin-top: 0.5rem;
            box-shadow: var(--card-shadow);
            font-size: 0.8rem;
            color: var(--dark);
            display: none;
            min-width: 200px;
            z-index: 1001;
        }

        .voice-feedback.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        /* Quick Action Buttons in Chatbot */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .quick-action-btn {
            background: var(--primary-light);
            color: var(--primary-dark);
            border: none;
            border-radius: 16px;
            padding: 0.4rem 0.8rem;
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-action-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .vault-content {
                flex-direction: column;
            }
            
            .vault-sidebar, .vault-items {
                width: 100%;
            }
            
            .vault-items {
                grid-template-columns: 1fr;
            }
            
            .ai-chatbot-container {
                width: calc(100% - 4rem);
                height: 400px;
                right: 2rem;
                left: 2rem;
            }
            
            .consent-actions {
                flex-direction: column;
                gap: 1rem;
            }
            
            .consent-details {
                text-align: center;
            }
            
            .consent-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .btn-consent {
                flex: 1;
            }
            
            .language-dropdown {
                width: 180px;
            }
        }
    </style>
</head>
<body class="trauma-informed">
    <!-- Voice Navigation -->
    <div class="voice-navigation">
        <button class="voice-control" id="voice-control">
            <i class="fas fa-microphone"></i>
        </button>
        <div class="voice-feedback" id="voice-feedback">
            Click to activate voice navigation
        </div>
    </div>

    <!-- Consent Modal -->
    <div id="consent-modal" class="consent-modal">
        <div class="consent-content">
            <div class="consent-header">
                <h2><i class="fas fa-shield-alt"></i> Welcome to EmpowerVault</h2>
                <p>Your privacy and security are our top priority</p>
            </div>
            
            <div class="consent-body">
                <div class="security-notice">
                    <i class="fas fa-lock"></i>
                    <div class="security-notice-content">
                        <h3>Military-Grade Encryption</h3>
                        <p>All your data is encrypted end-to-end. Only you can access your information with your unique encryption keys.</p>
                    </div>
                </div>

                <div class="consent-section">
                    <h3><i class="fas fa-user-shield"></i> Data Protection & Privacy</h3>
                    <p>We believe in transparency. Please review how we handle your sensitive information:</p>
                    
                    <div class="consent-options">
                        <div class="consent-option">
                            <input type="checkbox" id="consent-storage" checked required>
                            <div class="consent-label">
                                <h4>Secure Data Storage <span class="required-badge">REQUIRED</span></h4>
                                <p>I consent to storing my documents, journals, and recordings with military-grade encryption. My data remains encrypted and inaccessible to anyone without my explicit permission.</p>
                            </div>
                        </div>
                        
                        <div class="consent-option">
                            <input type="checkbox" id="consent-ai-tagging">
                            <div class="consent-label">
                                <h4>AI-Powered Organization <span class="optional-badge">OPTIONAL</span></h4>
                                <p>Allow AI to suggest tags and categories for your content to help you organize and find information faster. This processing happens locally on your device.</p>
                            </div>
                        </div>
                        
                        <div class="consent-option">
                            <input type="checkbox" id="consent-voice-processing">
                            <div class="consent-label">
                                <h4>Voice Recording Processing <span class="optional-badge">OPTIONAL</span></h4>
                                <p>Enable voice-to-text conversion and audio analysis to help organize your voice journals. All processing occurs on your device.</p>
                            </div>
                        </div>
                        
                        <div class="consent-option">
                            <input type="checkbox" id="consent-usage-analytics">
                            <div class="consent-label">
                                <h4>Anonymous Usage Analytics <span class="optional-badge">OPTIONAL</span></h4>
                                <p>Help us improve EmpowerVault by sharing anonymous usage data. No personal information or document content is included.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="consent-section">
                    <h3><i class="fas fa-eye"></i> Transparency Notice</h3>
                    <p><strong>Your Rights:</strong></p>
                    <ul style="color: var(--gray); margin: 0.5rem 0 1rem 1rem; line-height: 1.6;">
                        <li>You can withdraw consent for optional features at any time in Privacy Settings</li>
                        <li>Your data is never shared with third parties without your explicit permission</li>
                        <li>You can export or delete all your data at any time</li>
                        <li>The Emergency Exit feature immediately clears all local data</li>
                    </ul>
                    <p style="font-size: 0.9rem; color: var(--primary);"><i class="fas fa-info-circle"></i> <strong>Note:</strong> Required consents are essential for the basic functionality of EmpowerVault.</p>
                </div>
            </div>
            
            <div class="consent-footer">
                <div class="consent-actions">
                    <div class="consent-details">
                        <p><i class="fas fa-clock"></i> You can update these preferences anytime in Settings</p>
                        <p><i class="fas fa-download"></i> <a href="#" style="color: var(--primary);" id="privacy-policy-link">Review our complete Privacy Policy</a></p>
                    </div>
                    <div class="consent-buttons">
                        <button class="btn-consent btn-consent-secondary" id="consent-customize">Customize Settings</button>
                        <button class="btn-consent btn-consent-primary" id="consent-accept" disabled>Accept & Continue</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Emergency Exit Button with Pulse Animation -->
    <div class="emergency-exit">
        <a href="https://www.google.com" class="btn-emergency" id="emergency-exit-btn">
            <i class="fas fa-sign-out-alt"></i> <span data-translate="emergency_exit">Emergency Exit</span>
        </a>
    </div>
    
    <!-- Animated Header with Gradient -->
    <header class="app-header">
        <button class="menu-toggle" id="menu-toggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <h1 data-translate="app_title">EmpowerVault</h1>
        <div class="user-actions">
            <div class="language-selector">
                <button class="language-btn" id="language-btn">
                    <i class="fas fa-globe"></i>
                    <span id="current-language">English</span>
                    <i class="fas fa-chevron-down"></i>
                </button>
                <div class="language-dropdown" id="language-dropdown">
                    <!-- Languages will be populated by JavaScript -->
                </div>
            </div>
            <div class="privacy-settings">
                <button class="btn-icon" id="privacy-settings-btn">
                    <i class="fas fa-user-shield"></i>
                </button>
                <div class="privacy-menu" id="privacy-menu">
                    <div class="privacy-option" id="view-consent-settings">
                        <i class="fas fa-cog"></i>
                        <span data-translate="privacy_settings">Privacy Settings</span>
                    </div>
                    <div class="privacy-option" id="export-data">
                        <i class="fas fa-download"></i>
                        <span data-translate="export_data">Export My Data</span>
                    </div>
                    <div class="privacy-option" id="delete-data">
                        <i class="fas fa-trash"></i>
                        <span data-translate="delete_data">Delete All Data</span>
                    </div>
                </div>
            </div>
            <div class="consent-status" id="consent-status">
                <i class="fas fa-check-circle"></i>
                <span data-translate="privacy_protected">Privacy Protected</span>
            </div>
            <button class="btn-icon" id="vault-help">
                <i class="fas fa-question-circle"></i>
            </button>
        </div>
    </header>
    
    <!-- Main Vault Container -->
    <main class="vault-container">
        <!-- Data Usage Transparency Section -->
        <div class="data-usage">
            <h3><i class="fas fa-chart-bar"></i> <span data-translate="data_usage">Data Usage Transparency</span></h3>
            <div class="usage-item">
                <div class="usage-info">
                    <div class="usage-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <div class="usage-details">
                        <h4 data-translate="encrypted_storage">Encrypted Storage</h4>
                        <p data-translate="encrypted_storage_desc">Your files are encrypted before storage</p>
                    </div>
                </div>
                <span class="usage-status status-active" id="storage-status" data-translate="active">Active</span>
            </div>
            <div class="usage-item">
                <div class="usage-info">
                    <div class="usage-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="usage-details">
                        <h4 data-translate="ai_tagging">AI Tagging</h4>
                        <p data-translate="ai_tagging_desc">Automatic content organization</p>
                    </div>
                </div>
                <span class="usage-status status-active" id="ai-status" data-translate="active">Active</span>
            </div>
            <div class="usage-item">
                <div class="usage-info">
                    <div class="usage-icon">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="usage-details">
                        <h4 data-translate="voice_processing">Voice Processing</h4>
                        <p data-translate="voice_processing_desc">Audio analysis and transcription</p>
                    </div>
                </div>
                <span class="usage-status status-active" id="voice-status" data-translate="active">Active</span>
            </div>
        </div>

        <div class="vault-header">
            <h2 data-translate="vault_title">Your Secure Repository</h2>
            <p class="vault-description" data-translate="vault_description">Store legal documents, journal entries, healthcare records, and evidence logs with military-grade encryption.</p>
            
            <div class="vault-actions">
                <button class="btn-primary" id="upload-btn">
                    <i class="fas fa-upload"></i>
                    <span data-translate="upload_files">Upload Files</span>
                </button>
                <button class="btn-secondary" id="new-journal">
                    <i class="fas fa-book-medical"></i>
                    <span data-translate="new_journal">New Journal</span>
                </button>
                <div class="vault-search">
                    <input type="text" id="search-input" data-translate-placeholder="search_placeholder" placeholder="Search your vault...">
                    <button class="search-btn" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="vault-content">
            <!-- Interactive Sidebar -->
            <div class="vault-sidebar">
                <div class="vault-categories">
                    <h3><i class="fas fa-folder-open"></i> <span data-translate="categories">Categories</span></h3>
                    <ul>
                        <li class="active" data-category="all">
                            <i class="fas fa-layer-group"></i> <span data-translate="all_items">All Items</span>
                        </li>
                        <li data-category="legal">
                            <i class="fas fa-gavel"></i> <span data-translate="legal_documents">Legal Documents</span>
                        </li>
                        <li data-category="medical">
                            <i class="fas fa-file-medical"></i> <span data-translate="medical_records">Medical Records</span>
                        </li>
                        <li data-category="evidence">
                            <i class="fas fa-fingerprint"></i> <span data-translate="evidence_logs">Evidence Logs</span>
                        </li>
                        <li data-category="journal">
                            <i class="fas fa-book-open"></i> <span data-translate="journal_entries">Journal Entries</span>
                        </li>
                        <li data-category="audio">
                            <i class="fas fa-microphone"></i> <span data-translate="voice_journals">Voice Journals</span>
                        </li>
                        <li data-category="other">
                            <i class="fas fa-archive"></i> <span data-translate="other">Other</span>
                        </li>
                    </ul>
                </div>
                
                <div class="vault-tags">
                    <h3><i class="fas fa-tags"></i> <span data-translate="ai_tags">AI-Suggested Tags</span></h3>
                    <div class="tag-cloud">
                        <span class="tag" data-tag="court">
                            <i class="fas fa-balance-scale"></i> <span data-translate="court">court</span>
                        </span>
                        <span class="tag" data-tag="therapy">
                            <i class="fas fa-heart"></i> <span data-translate="therapy">therapy</span>
                        </span>
                        <span class="tag" data-tag="police-report">
                            <i class="fas fa-shield-alt"></i> <span data-translate="police_report">police report</span>
                        </span>
                        <span class="tag" data-tag="progress">
                            <i class="fas fa-chart-line"></i> <span data-translate="progress">progress</span>
                        </span>
                        <span class="tag" data-tag="important">
                            <i class="fas fa-exclamation-circle"></i> <span data-translate="important">important</span>
                        </span>
                        <span class="tag" data-tag="urgent">
                            <i class="fas fa-clock"></i> <span data-translate="urgent">urgent</span>
                        </span>
                    </div>
                </div>
                
                <div class="vault-stats">
                    <h3><i class="fas fa-chart-pie"></i> <span data-translate="vault_stats">Vault Statistics</span></h3>
                    <div class="stat-item">
                        <span class="stat-label">
                            <i class="fas fa-file-alt"></i> <span data-translate="total_items">Total Items</span>
                        </span>
                        <span class="stat-value" id="total-items">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">
                            <i class="fas fa-lock"></i> <span data-translate="encrypted">Encrypted</span>
                        </span>
                        <span class="stat-value">100%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">
                            <i class="fas fa-database"></i> <span data-translate="storage_used">Storage Used</span>
                        </span>
                        <span class="stat-value">0%</span>
                    </div>
                </div>
            </div>
            
            <!-- Interactive Vault Items Grid -->
            <div class="vault-items" id="vault-items-container">
                <!-- Items will be dynamically added here -->
            </div>
        </div>
    </main>
    
    <!-- Upload Modal with Interactive Options -->
    <div id="upload-modal" class="modal">
        <div class="modal-content">
            <h2 data-translate="upload_title">Upload to EmpowerVault</h2>
            <div class="upload-options">
                <div class="upload-option" id="upload-file">
                    <i class="fas fa-file-upload"></i>
                    <h3 data-translate="upload_file">Upload File</h3>
                    <p data-translate="upload_file_desc">Documents, photos, videos</p>
                    <input type="file" id="file-upload" style="display: none;" multiple>
                </div>
                <div class="upload-option" id="record-audio">
                    <i class="fas fa-microphone"></i>
                    <h3 data-translate="record_audio">Record Audio</h3>
                    <p data-translate="record_audio_desc">Voice notes, statements</p>
                </div>
                <div class="upload-option" id="create-doc">
                    <i class="fas fa-file-word"></i>
                    <h3 data-translate="create_doc">Create Document</h3>
                    <p data-translate="create_doc_desc">Journal, notes, logs</p>
                </div>
            </div>
            
            <div class="upload-security">
                <h3 data-translate="security_options">Security Options</h3>
                <div class="security-option">
                    <input type="checkbox" id="extra-encryption" checked>
                    <label for="extra-encryption">
                        <i class="fas fa-lock"></i> <span data-translate="double_encryption">Double Encryption</span>
                    </label>
                </div>
                <div class="security-option">
                    <input type="checkbox" id="auto-tagging" checked>
                    <label for="auto-tagging">
                        <i class="fas fa-tags"></i> <span data-translate="ai_auto_tagging">AI Auto-Tagging</span>
                    </label>
                </div>
                <div class="security-option">
                    <input type="checkbox" id="local-backup">
                    <label for="local-backup">
                        <i class="fas fa-hdd"></i> <span data-translate="local_backup">Local Backup</span>
                    </label>
                </div>
            </div>
            
            <div class="upload-progress" id="upload-progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text" data-translate="preparing_upload">Preparing upload...</div>
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" id="cancel-upload" data-translate="cancel">Cancel</button>
                <button class="btn-primary" id="confirm-upload" disabled data-translate="upload_securely">Upload Securely</button>
            </div>
        </div>
    </div>
    
    <!-- Journal Entry Modal with Voice-to-Text -->
    <div id="journal-modal" class="modal">
        <div class="modal-content">
            <h2 data-translate="new_journal_title">New Journal Entry</h2>
            <div class="journal-entry">
                <div class="form-group">
                    <label for="journal-title" data-translate="journal_title">Title</label>
                    <input type="text" id="journal-title" data-translate-placeholder="journal_title_placeholder" placeholder="Give your entry a title">
                </div>
                
                <div class="form-group">
                    <label for="journal-content" data-translate="journal_content">Content</label>
                    <div class="voice-controls">
                        <button class="btn-voice" id="start-voice-input">
                            <i class="fas fa-microphone"></i>
                            <span data-translate="start_voice_input">Start Voice Input</span>
                        </button>
                        <button class="btn-secondary" id="translate-content" style="display: none;">
                            <i class="fas fa-language"></i>
                            <span data-translate="translate">Translate</span>
                        </button>
                    </div>
                    <textarea id="journal-content" rows="10" data-translate-placeholder="journal_content_placeholder" placeholder="Write your thoughts, feelings, or experiences here..."></textarea>
                    
                    <div class="transcript-preview" id="transcript-preview">
                        <div class="transcript-text" id="transcript-text"></div>
                        <div class="transcript-actions">
                            <button class="btn-secondary" id="cancel-transcript" data-translate="cancel">Cancel</button>
                            <button class="btn-primary" id="apply-transcript" data-translate="apply">Apply</button>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="journal-tags" data-translate="journal_tags">Tags</label>
                    <input type="text" id="journal-tags" data-translate-placeholder="journal_tags_placeholder" placeholder="Add tags separated by commas">
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="cancel-journal" data-translate="cancel">Cancel</button>
                <button class="btn-primary" id="save-journal" data-translate="save_entry">Save Entry</button>
            </div>
        </div>
    </div>
    
    <!-- Voice Recording Modal -->
    <div id="voice-modal" class="modal">
        <div class="modal-content">
            <h2 data-translate="record_voice_title">Record Voice Journal</h2>
            <div class="audio-recorder">
                <div class="recording-indicator" id="recording-indicator" style="display: none;">
                    <i class="fas fa-circle"></i>
                    <span data-translate="recording_in_progress">Recording in progress...</span>
                </div>
                <div class="audio-visualizer" id="audio-visualizer">
                    <canvas id="visualizer"></canvas>
                </div>
                <div class="audio-controls">
                    <button id="start-recording">
                        <i class="fas fa-microphone"></i> <span data-translate="start">Start</span>
                    </button>
                    <button id="stop-recording" disabled>
                        <i class="fas fa-stop"></i> <span data-translate="stop">Stop</span>
                    </button>
                    <button id="play-recording" disabled>
                        <i class="fas fa-play"></i> <span data-translate="play">Play</span>
                    </button>
                </div>
                <div class="recording-timer" id="recording-timer">00:00</div>
                
                <div class="audio-player" id="audio-player" style="display: none;">
                    <audio id="recorded-audio" controls></audio>
                </div>
            </div>
            
            <div class="form-group">
                <label for="voice-title" data-translate="voice_title">Title</label>
                <input type="text" id="voice-title" data-translate-placeholder="voice_title_placeholder" placeholder="Give your voice journal a title">
            </div>
            <div class="form-group">
                <label for="voice-tags" data-translate="voice_tags">Tags</label>
                <input type="text" id="voice-tags" data-translate-placeholder="voice_tags_placeholder" placeholder="Add tags separated by commas">
            </div>
            
            <div class="modal-actions">
                <button class="btn-secondary" id="cancel-voice" data-translate="cancel">Cancel</button>
                <button class="btn-primary" id="save-voice" disabled data-translate="save_voice_journal">Save Voice Journal</button>
            </div>
        </div>
    </div>
    
    <!-- AI Assistant Chatbot -->
    <div class="ai-chatbot-container" id="ai-chatbot" style="display: none;">
        <div class="ai-chatbot-header">
            <h3><i class="fas fa-robot"></i> <span data-translate="vault_assistant">Vault Assistant</span></h3>
            <button class="btn-icon" id="close-chatbot" style="color: white;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="ai-chatbot-messages" id="chatbot-messages">
            <div class="ai-message ai-response">
                <div class="message-content">
                    <p data-translate="assistant_welcome">Hello! I'm your Vault Assistant. I can help you with uploading files, creating journal entries, recording voice notes, searching your vault, and securing your documents. How can I assist you today?</p>
                    <div class="quick-actions">
                        <button class="quick-action-btn" data-action="upload">Upload Files</button>
                        <button class="quick-action-btn" data-action="journal">New Journal</button>
                        <button class="quick-action-btn" data-action="search">Search Vault</button>
                        <button class="quick-action-btn" data-action="security">Security Help</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="ai-chatbot-input">
            <textarea id="chatbot-input" data-translate-placeholder="assistant_placeholder" placeholder="Ask me anything about your vault..."></textarea>
            <div class="chat-controls">
                <button class="btn-secondary" id="voice-chat-btn">
                    <i class="fas fa-microphone"></i>
                </button>
                <button class="btn-secondary" id="quick-upload-help" data-translate="upload_help">Upload Help</button>
                <button class="btn-primary" id="send-message" data-translate="send">Send</button>
            </div>
        </div>
    </div>
    
    <button class="ai-chatbot-toggle" id="ai-chatbot-toggle">
        <i class="fas fa-robot"></i>
    </button>

    <script>
        // Language translations for all 11 official South African languages
        const translations = {
            'en': {
                'app_title': 'EmpowerVault',
                'vault_title': 'Your Secure Repository',
                'vault_description': 'Store legal documents, journal entries, healthcare records, and evidence logs with military-grade encryption.',
                'upload_files': 'Upload Files',
                'new_journal': 'New Journal',
                'search_placeholder': 'Search your vault...',
                'categories': 'Categories',
                'all_items': 'All Items',
                'legal_documents': 'Legal Documents',
                'medical_records': 'Medical Records',
                'evidence_logs': 'Evidence Logs',
                'journal_entries': 'Journal Entries',
                'voice_journals': 'Voice Journals',
                'other': 'Other',
                'ai_tags': 'AI-Suggested Tags',
                'court': 'court',
                'therapy': 'therapy',
                'police_report': 'police report',
                'progress': 'progress',
                'important': 'important',
                'urgent': 'urgent',
                'vault_stats': 'Vault Statistics',
                'total_items': 'Total Items',
                'encrypted': 'Encrypted',
                'storage_used': 'Storage Used',
                'emergency_exit': 'Emergency Exit',
                'upload_title': 'Upload to EmpowerVault',
                'upload_file': 'Upload File',
                'upload_file_desc': 'Documents, photos, videos',
                'record_audio': 'Record Audio',
                'record_audio_desc': 'Voice notes, statements',
                'create_doc': 'Create Document',
                'create_doc_desc': 'Journal, notes, logs',
                'security_options': 'Security Options',
                'double_encryption': 'Double Encryption',
                'ai_auto_tagging': 'AI Auto-Tagging',
                'local_backup': 'Local Backup',
                'preparing_upload': 'Preparing upload...',
                'cancel': 'Cancel',
                'upload_securely': 'Upload Securely',
                'new_journal_title': 'New Journal Entry',
                'journal_title': 'Title',
                'journal_title_placeholder': 'Give your entry a title',
                'journal_content': 'Content',
                'journal_content_placeholder': 'Write your thoughts, feelings, or experiences here...',
                'journal_tags': 'Tags',
                'journal_tags_placeholder': 'Add tags separated by commas',
                'save_entry': 'Save Entry',
                'record_voice_title': 'Record Voice Journal',
                'recording_in_progress': 'Recording in progress...',
                'start': 'Start',
                'stop': 'Stop',
                'play': 'Play',
                'voice_title': 'Title',
                'voice_title_placeholder': 'Give your voice journal a title',
                'voice_tags': 'Tags',
                'voice_tags_placeholder': 'Add tags separated by commas',
                'save_voice_journal': 'Save Voice Journal',
                'vault_assistant': 'Vault Assistant',
                'assistant_welcome': 'Hello! I\'m your Vault Assistant. I can help you with uploading files, creating journal entries, recording voice notes, searching your vault, and securing your documents. How can I assist you today?',
                'assistant_placeholder': 'Ask me anything about your vault...',
                'upload_help': 'Upload Help',
                'send': 'Send',
                'privacy_settings': 'Privacy Settings',
                'export_data': 'Export My Data',
                'delete_data': 'Delete All Data',
                'privacy_protected': 'Privacy Protected',
                'data_usage': 'Data Usage Transparency',
                'encrypted_storage': 'Encrypted Storage',
                'encrypted_storage_desc': 'Your files are encrypted before storage',
                'ai_tagging': 'AI Tagging',
                'ai_tagging_desc': 'Automatic content organization',
                'voice_processing': 'Voice Processing',
                'voice_processing_desc': 'Audio analysis and transcription',
                'active': 'Active',
                'inactive': 'Inactive',
                'start_voice_input': 'Start Voice Input',
                'translate': 'Translate',
                'apply': 'Apply'
            },
            'zu': {
                'app_title': 'I-EmpowerVault',
                'vault_title': 'Indawo Yakho Ephephile',
                'vault_description': 'Gcina amadokhumenti ezomthetho, okungeniswa kwejenali, amarekhodi ezempilo, namarekhodi ebufakazi ngokubethela okusezingeni lempi.',
                'upload_files': 'Layisha Amefayili',
                'new_journal': 'Ijenali Entsha',
                'search_placeholder': 'Sesha indawo yakho yokugcina...',
                'categories': 'Izigaba',
                'all_items': 'Zonke Izinto',
                'legal_documents': 'Amadokhumenti Ezomthetho',
                'medical_records': 'Amarekhodi Ezempilo',
                'evidence_logs': 'Amarekhodi Bobufakazi',
                'journal_entries': 'Okungeniswe Kwijenali',
                'voice_journals': 'Amajenali Omzimba',
                'other': 'Okunye',
                'ai_tags': 'Amathegi Ahlongozwayo nge-AI',
                'court': 'inkantolo',
                'therapy': 'ukwelapha',
                'police_report': 'umbiko wamaphoyisa',
                'progress': 'intuthuko',
                'important': 'kubalulekile',
                'urgent': 'okuphuthumayo',
                'vault_stats': 'Izibalo Zendawo Yokugcina',
                'total_items': 'Isamba Sezinto',
                'encrypted': 'Kubethelwe',
                'storage_used': 'Isitoreji Esisetshenzisiwe',
                'emergency_exit': 'Ukuphuma Okuphuthumayo',
                'upload_title': 'Layisha Ku-EmpowerVault',
                'upload_file': 'Layisha Ifayili',
                'upload_file_desc': 'Amadokhumenti, izithombe, amavidiyo',
                'record_audio': 'Qopha Umsindo',
                'record_audio_desc': 'Amanothi omzimba, izitatimende',
                'create_doc': 'Dala Idokhumenti',
                'create_doc_desc': 'Ijenali, amanothi, amarekhodi',
                'security_options': 'Izinketho Zokuphepha',
                'double_encryption': 'Ukubethela Okukabili',
                'ai_auto_tagging': 'Ukumaka Okuzenzakalelayo kwe-AI',
                'local_backup': 'Isipele Sendawo',
                'preparing_upload': 'Ilungiselela ukulayisha...',
                'cancel': 'Khansela',
                'upload_securely': 'Layisha Ngokuphepha',
                'new_journal_title': 'Okungeniswa Kwijenali Entsha',
                'journal_title': 'Isihloko',
                'journal_title_placeholder': 'Nika okungeniswa kwakho isihloko',
                'journal_content': 'Okuqukethwe',
                'journal_content_placeholder': 'Bhala imicabango, imizwa, noma izinto ohlangabezane nazo lapha...',
                'journal_tags': 'Amathegi',
                'journal_tags_placeholder': 'Engeza amathegi ahlukaniswe ngamakhoma',
                'save_entry': 'Londoloza Okungenisiwe',
                'record_voice_title': 'Qopha Ijenali Yezwi',
                'recording_in_progress': 'Ukuqoshwa kuyasebenza...',
                'start': 'Qala',
                'stop': 'Yima',
                'play': 'Dlala',
                'voice_title': 'Isihloko',
                'voice_title_placeholder': 'Nika ijenali yakho yezwi isihloko',
                'voice_tags': 'Amathegi',
                'voice_tags_placeholder': 'Engeza amathegi ahlukaniswe ngamakhoma',
                'save_voice_journal': 'Londoloza Ijenali Yezwi',
                'vault_assistant': 'UmSizi Wendawo Yokugcina',
                'assistant_welcome': 'Sawubona! NgingumSizi Wakho Wendawo Yokugcina. Ngingakusiza ngokulayisha amafayili, ukudala okungeniswa kwejenali, ukuqopha amanothi omzimba, ukusesha indawo yakho yokugcina, nokuvikela amadokhumenti akho. Ngingakusiza kanjani namuhla?',
                'assistant_placeholder': 'Ngibuza noma yini mayelana nendawo yakho yokugcina...',
                'upload_help': 'Usizo Lokulayisha',
                'send': 'Thumela',
                'privacy_settings': 'Izilungiselelo Zobumfihlo',
                'export_data': 'Khipha Idatha Yami',
                'delete_data': 'Sula Yonke Idatha',
                'privacy_protected': 'Ubulungiswa Bezimfihlo',
                'data_usage': 'Ukusetshenziswa Kwedatha Okusobala',
                'encrypted_storage': 'Isitoreji Esibethelwe',
                'encrypted_storage_desc': 'Amefayili akho abethelwa ngaphambi kokugcinwa',
                'ai_tagging': 'Ukumakwa kwe-AI',
                'ai_tagging_desc': 'Ukuhlela okuzenzakalelayo kokuqukethwe',
                'voice_processing': 'Ukucubungula Izwi',
                'voice_processing_desc': 'Ukuhlaziya nokuloba umsindo',
                'active': 'Iyasebenza',
                'inactive': 'Ayisebenzi',
                'start_voice_input': 'Qala Ukufaka Ngomlomo',
                'translate': 'Humusha',
                'apply': 'Faka'
            },
            // Additional languages would be added here (xh, af, nso, tn, ts, ss, ve, nr, st)
            // For brevity, I'm showing English and Zulu as examples
        };

        // Language configuration
        const languages = [
            { code: 'en', name: 'English', flag: '🇺🇸' },
            { code: 'zu', name: 'isiZulu', flag: '🇿🇦' },
            { code: 'xh', name: 'isiXhosa', flag: '🇿🇦' },
            { code: 'af', name: 'Afrikaans', flag: '🇿🇦' },
            { code: 'nso', name: 'Sesotho sa Leboa', flag: '🇿🇦' },
            { code: 'tn', name: 'Setswana', flag: '🇿🇦' },
            { code: 'ts', name: 'Xitsonga', flag: '🇿🇦' },
            { code: 'ss', name: 'siSwati', flag: '🇿🇦' },
            { code: 've', name: 'Tshivenda', flag: '🇿🇦' },
            { code: 'nr', name: 'isiNdebele', flag: '🇿🇦' },
            { code: 'st', name: 'Sesotho', flag: '🇿🇦' }
        ];

        // Current language
        let currentLanguage = 'en';

        // Function to change language
        function changeLanguage(langCode) {
            currentLanguage = langCode;
            updateLanguageDisplay();
            applyTranslations();
            saveLanguagePreference();
        }

        // Function to update language display
        function updateLanguageDisplay() {
            const currentLang = languages.find(lang => lang.code === currentLanguage);
            document.getElementById('current-language').textContent = currentLang.name;
        }

        // Function to apply translations
        function applyTranslations() {
            // Translate elements with data-translate attribute
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });

            // Translate placeholder attributes
            document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
                const key = element.getAttribute('data-translate-placeholder');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.setAttribute('placeholder', translations[currentLanguage][key]);
                }
            });
        }

        // Function to save language preference
        function saveLanguagePreference() {
            localStorage.setItem('empowerVaultLanguage', currentLanguage);
        }

        // Function to load language preference
        function loadLanguagePreference() {
            const savedLanguage = localStorage.getItem('empowerVaultLanguage');
            if (savedLanguage && translations[savedLanguage]) {
                currentLanguage = savedLanguage;
            }
            updateLanguageDisplay();
            applyTranslations();
        }

        // Initialize language dropdown
        function initLanguageDropdown() {
            const dropdown = document.getElementById('language-dropdown');
            const languageBtn = document.getElementById('language-btn');
            
            // Populate dropdown with languages
            languages.forEach(lang => {
                const option = document.createElement('div');
                option.className = 'language-option';
                option.innerHTML = `
                    <span class="language-flag">${lang.flag}</span>
                    <span>${lang.name}</span>
                `;
                option.addEventListener('click', () => {
                    changeLanguage(lang.code);
                    dropdown.classList.remove('show');
                });
                dropdown.appendChild(option);
            });
            
            // Toggle dropdown
            languageBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                dropdown.classList.toggle('show');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', () => {
                dropdown.classList.remove('show');
            });
        }

        // Voice Navigation System
        const voiceNavigation = {
            recognition: null,
            isListening: false,
            commands: {
                'upload': () => document.getElementById('upload-btn').click(),
                'new journal': () => document.getElementById('new-journal').click(),
                'search': () => document.getElementById('search-input').focus(),
                'help': () => document.getElementById('vault-help').click(),
                'assistant': () => document.getElementById('ai-chatbot-toggle').click(),
                'legal': () => this.filterByCategory('legal'),
                'medical': () => this.filterByCategory('medical'),
                'evidence': () => this.filterByCategory('evidence'),
                'journal': () => this.filterByCategory('journal'),
                'audio': () => this.filterByCategory('audio'),
                'all': () => this.filterByCategory('all'),
                'privacy': () => document.getElementById('privacy-settings-btn').click(),
                'emergency': () => document.getElementById('emergency-exit-btn').click(),
                'close': () => this.closeModals()
            },

            init: function() {
                // Check for browser support
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    console.warn('Speech recognition not supported in this browser');
                    return false;
                }

                // Initialize speech recognition
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                this.recognition.continuous = false;
                this.recognition.interimResults = false;
                this.recognition.lang = currentLanguage;

                this.recognition.onstart = () => {
                    this.isListening = true;
                    document.getElementById('voice-control').classList.add('listening');
                    this.showFeedback('Listening... Speak now');
                };

                this.recognition.onend = () => {
                    this.isListening = false;
                    document.getElementById('voice-control').classList.remove('listening');
                    this.showFeedback('Click to activate voice navigation');
                };

                this.recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript.toLowerCase().trim();
                    this.processCommand(transcript);
                };

                this.recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    if (event.error === 'not-allowed') {
                        this.showFeedback('Microphone access denied. Please allow microphone access.');
                    } else {
                        this.showFeedback('Voice recognition error. Please try again.');
                    }
                    this.isListening = false;
                    document.getElementById('voice-control').classList.remove('listening');
                };

                // Set up voice control button
                document.getElementById('voice-control').addEventListener('click', () => {
                    this.toggleListening();
                });

                return true;
            },

            toggleListening: function() {
                if (this.isListening) {
                    this.recognition.stop();
                } else {
                    this.recognition.lang = currentLanguage;
                    try {
                        this.recognition.start();
                    } catch (error) {
                        console.error('Error starting speech recognition:', error);
                        this.showFeedback('Error starting voice recognition');
                    }
                }
            },

            processCommand: function(transcript) {
                this.showFeedback(`Heard: "${transcript}"`);
                
                // Check for exact matches first
                if (this.commands[transcript]) {
                    this.commands[transcript]();
                    return;
                }
                
                // Check for partial matches
                for (const command in this.commands) {
                    if (transcript.includes(command)) {
                        this.commands[command]();
                        return;
                    }
                }
                
                // If no command matched, send to chatbot
                this.sendToChatbot(transcript);
            },

            sendToChatbot: function(transcript) {
                const chatbotInput = document.getElementById('chatbot-input');
                const sendMessageBtn = document.getElementById('send-message');
                
                if (chatbotInput && sendMessageBtn) {
                    chatbotInput.value = transcript;
                    sendMessageBtn.click();
                }
            },

            filterByCategory: function(category) {
                const categoryItems = document.querySelectorAll('.vault-categories li');
                categoryItems.forEach(item => {
                    if (item.getAttribute('data-category') === category) {
                        item.click();
                    }
                });
            },

            closeModals: function() {
                const modals = document.querySelectorAll('.modal');
                modals.forEach(modal => {
                    modal.style.display = 'none';
                });
            },

            showFeedback: function(message) {
                const feedback = document.getElementById('voice-feedback');
                feedback.textContent = message;
                feedback.classList.add('show');
                
                setTimeout(() => {
                    feedback.classList.remove('show');
                }, 3000);
            }
        };

        // Voice-to-Text functionality
        const voiceToTextManager = {
            recognition: null,
            isListening: false,
            finalTranscript: '',
            interimTranscript: '',

            init: function() {
                // Check for browser support
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    console.warn('Speech recognition not supported in this browser');
                    return false;
                }

                // Initialize speech recognition
                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                this.recognition.continuous = true;
                this.recognition.interimResults = true;
                this.recognition.lang = currentLanguage;

                this.recognition.onstart = () => {
                    this.isListening = true;
                    document.getElementById('start-voice-input').classList.add('recording');
                    document.getElementById('start-voice-input').innerHTML = '<i class="fas fa-microphone-slash"></i> Stop Voice Input';
                };

                this.recognition.onend = () => {
                    this.isListening = false;
                    document.getElementById('start-voice-input').classList.remove('recording');
                    document.getElementById('start-voice-input').innerHTML = '<i class="fas fa-microphone"></i> Start Voice Input';
                };

                this.recognition.onresult = (event) => {
                    this.interimTranscript = '';
                    
                    for (let i = event.resultIndex; i < event.results.length; i++) {
                        const transcript = event.results[i][0].transcript;
                        if (event.results[i].isFinal) {
                            this.finalTranscript += transcript + ' ';
                        } else {
                            this.interimTranscript += transcript;
                        }
                    }
                    
                    this.updateTranscriptPreview();
                };

                this.recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                    if (event.error === 'not-allowed') {
                        alert('Microphone access denied. Please allow microphone access to use voice input.');
                    }
                    this.stopListening();
                };

                return true;
            },

            startListening: function() {
                if (!this.recognition) {
                    if (!this.init()) {
                        alert('Voice input is not supported in your browser. Please use Chrome, Edge, or Safari.');
                        return;
                    }
                }

                this.finalTranscript = '';
                this.interimTranscript = '';
                this.recognition.lang = currentLanguage;
                
                try {
                    this.recognition.start();
                } catch (error) {
                    console.error('Error starting speech recognition:', error);
                }
            },

            stopListening: function() {
                if (this.recognition && this.isListening) {
                    this.recognition.stop();
                }
            },

            toggleListening: function() {
                if (this.isListening) {
                    this.stopListening();
                } else {
                    this.startListening();
                }
            },

            updateTranscriptPreview: function() {
                const preview = document.getElementById('transcript-preview');
                const text = document.getElementById('transcript-text');
                
                if (this.finalTranscript || this.interimTranscript) {
                    preview.classList.add('show');
                    text.textContent = this.finalTranscript + this.interimTranscript;
                } else {
                    preview.classList.remove('show');
                }
            },

            applyTranscript: function() {
                const journalContent = document.getElementById('journal-content');
                journalContent.value += this.finalTranscript;
                this.finalTranscript = '';
                this.interimTranscript = '';
                this.updateTranscriptPreview();
            },

            cancelTranscript: function() {
                this.finalTranscript = '';
                this.interimTranscript = '';
                this.updateTranscriptPreview();
                this.stopListening();
            }
        };

        // AI Assistant with supportive responses
        const aiAssistant = {
            responses: {
                greeting: [
                    "Hello! I'm your Vault Assistant. I'm here to help you organize and secure your important documents and memories.",
                    "Hi there! I'm so glad you're here. I'm ready to help you with anything you need in your EmpowerVault.",
                    "Welcome back! I'm here to support you in organizing and protecting your important information."
                ],
                upload: [
                    "I can help you upload files to your secure vault. You can upload documents, photos, or record audio directly.",
                    "Let's get your files securely stored. You can upload documents, photos, or record voice notes - all protected with military-grade encryption.",
                    "Ready to upload? Your files will be safe and secure in the vault. I'm here to guide you through the process."
                ],
                journal: [
                    "Journaling can be a powerful tool for processing experiences. I'm here to help you create a safe space for your thoughts.",
                    "Let's create a journal entry together. You can type or use voice input - whatever feels most comfortable for you.",
                    "Your journal is a private space just for you. I'm honored to help you document your thoughts and feelings."
                ],
                search: [
                    "I can help you find anything in your vault. Just tell me what you're looking for.",
                    "Let's search your vault together. I'll help you find exactly what you need.",
                    "Looking for something specific? I'm here to help you navigate your secure documents."
                ],
                support: [
                    "You're doing important work by organizing and protecting your information. I'm proud of you for taking these steps.",
                    "Remember, you're not alone in this process. I'm here to support you every step of the way.",
                    "Taking control of your documents and memories is a brave step. I'm here to help make it easier for you."
                ],
                encouragement: [
                    "You're taking powerful steps toward organizing and protecting what matters to you. That's truly commendable.",
                    "I see how much care you're putting into this process. Your dedication to your wellbeing is inspiring.",
                    "Every entry you make, every document you secure - it all matters. You're building a foundation of strength and organization."
                ],
                security: [
                    "Your security is our top priority. All files are encrypted with military-grade encryption before storage.",
                    "I want to reassure you that your data is completely secure. We use end-to-end encryption so only you can access your information.",
                    "Your privacy is protected here. All documents are encrypted locally on your device before being stored."
                ],
                unknown: [
                    "I'm not sure I understand. Could you try rephrasing that? I'm here to help with uploading files, creating journals, searching your vault, or answering questions about security.",
                    "I want to make sure I help you properly. Could you tell me more about what you need? I can assist with file management, journaling, or security questions.",
                    "Let me know how I can best support you. I can help with uploading documents, creating journal entries, or finding information in your vault."
                ]
            },

            getResponse: function(userMessage) {
                const message = userMessage.toLowerCase();
                
                // Check for specific intents
                if (message.includes('hello') || message.includes('hi') || message.includes('hey')) {
                    return this.getRandomResponse('greeting');
                } else if (message.includes('upload') || message.includes('file') || message.includes('document')) {
                    return this.getRandomResponse('upload');
                } else if (message.includes('journal') || message.includes('write') || message.includes('entry')) {
                    return this.getRandomResponse('journal');
                } else if (message.includes('search') || message.includes('find') || message.includes('look')) {
                    return this.getRandomResponse('search');
                } else if (message.includes('help') || message.includes('support') || message.includes('assist')) {
                    return this.getRandomResponse('support');
                } else if (message.includes('security') || message.includes('encryption') || message.includes('privacy')) {
                    return this.getRandomResponse('security');
                } else if (message.includes('thank') || message.includes('appreciate') || message.includes('grateful')) {
                    return "You're very welcome! I'm honored to support you in this important work. Remember, you're doing great.";
                } else if (message.includes('how are you') || message.includes('how do you feel')) {
                    return "I'm here and fully focused on supporting you. How are you feeling today?";
                } else {
                    // Occasionally mix in encouragement with unknown responses
                    if (Math.random() > 0.7) {
                        return this.getRandomResponse('encouragement') + " " + this.getRandomResponse('unknown');
                    }
                    return this.getRandomResponse('unknown');
                }
            },

            getRandomResponse: function(category) {
                const responses = this.responses[category];
                return responses[Math.floor(Math.random() * responses.length)];
            },

            addMessage: function(message, isUser = false) {
                const messagesContainer = document.getElementById('chatbot-messages');
                const messageElement = document.createElement('div');
                messageElement.className = `ai-message ${isUser ? 'user-message' : 'ai-response'}`;
                
                const messageContent = document.createElement('div');
                messageContent.className = 'message-content';
                messageContent.innerHTML = `<p>${message}</p>`;
                
                messageElement.appendChild(messageContent);
                messagesContainer.appendChild(messageElement);
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Save to conversation history
                this.saveConversation(message, isUser);
            },

            saveConversation: function(message, isUser) {
                chatbotConversations.push({
                    message: message,
                    isUser: isUser,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 50 messages
                if (chatbotConversations.length > 50) {
                    chatbotConversations = chatbotConversations.slice(-50);
                }
                
                localStorage.setItem('empowerVaultChatHistory', JSON.stringify(chatbotConversations));
            },

            showTypingIndicator: function() {
                const messagesContainer = document.getElementById('chatbot-messages');
                const typingElement = document.createElement('div');
                typingElement.className = 'typing-indicator';
                typingElement.id = 'typing-indicator';
                typingElement.innerHTML = `
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                messagesContainer.appendChild(typingElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            },

            hideTypingIndicator: function() {
                const typingElement = document.getElementById('typing-indicator');
                if (typingElement) {
                    typingElement.remove();
                }
            },

            processUserMessage: function(message) {
                this.addMessage(message, true);
                
                // Show typing indicator
                this.showTypingIndicator();
                
                // Simulate AI thinking time
                setTimeout(() => {
                    this.hideTypingIndicator();
                    const response = this.getResponse(message);
                    this.addMessage(response);
                    
                    // Add quick actions for certain responses
                    if (message.includes('upload') || message.includes('file')) {
                        this.addQuickActions(['Upload File', 'Record Audio', 'Create Document']);
                    } else if (message.includes('journal') || message.includes('write')) {
                        this.addQuickActions(['New Journal', 'Voice Journal', 'View Journals']);
                    } else if (message.includes('search') || message.includes('find')) {
                        this.addQuickActions(['Search All', 'Legal Docs', 'Medical Records']);
                    }
                }, 1000 + Math.random() * 1000);
            },

            addQuickActions: function(actions) {
                const messagesContainer = document.getElementById('chatbot-messages');
                const lastMessage = messagesContainer.lastChild;
                
                const quickActions = document.createElement('div');
                quickActions.className = 'quick-actions';
                
                actions.forEach(action => {
                    const button = document.createElement('button');
                    button.className = 'quick-action-btn';
                    button.textContent = action;
                    button.setAttribute('data-action', action.toLowerCase().replace(' ', '-'));
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.handleQuickAction(action);
                    });
                    quickActions.appendChild(button);
                });
                
                lastMessage.querySelector('.message-content').appendChild(quickActions);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            },

            handleQuickAction: function(action) {
                this.addMessage(action, true);
                
                // Show typing indicator
                this.showTypingIndicator();
                
                setTimeout(() => {
                    this.hideTypingIndicator();
                    
                    switch(action) {
                        case 'Upload File':
                            document.getElementById('upload-btn').click();
                            this.addMessage("I'm opening the upload dialog for you. You can select files to upload securely.");
                            break;
                        case 'Record Audio':
                            document.getElementById('record-audio').click();
                            this.addMessage("Opening the audio recorder. You can record voice notes or statements securely.");
                            break;
                        case 'Create Document':
                            document.getElementById('create-doc').click();
                            this.addMessage("Opening the document creator. You can type or use voice input to create secure notes.");
                            break;
                        case 'New Journal':
                            document.getElementById('new-journal').click();
                            this.addMessage("Opening a new journal entry. This is your private space for thoughts and reflections.");
                            break;
                        case 'Voice Journal':
                            document.getElementById('record-audio').click();
                            this.addMessage("Opening the voice journal recorder. You can record your thoughts and feelings securely.");
                            break;
                        case 'Search All':
                            document.getElementById('search-input').focus();
                            this.addMessage("I've focused the search bar for you. You can search through all your vault items.");
                            break;
                        case 'Legal Docs':
                            this.filterByCategory('legal');
                            this.addMessage("Showing your legal documents. These are securely encrypted and only accessible to you.");
                            break;
                        case 'Medical Records':
                            this.filterByCategory('medical');
                            this.addMessage("Showing your medical records. Your health information is protected with the highest security.");
                            break;
                        default:
                            this.addMessage(`I've triggered the ${action} action for you. How else can I assist?`);
                    }
                }, 800);
            },

            filterByCategory: function(category) {
                const categoryItems = document.querySelectorAll('.vault-categories li');
                categoryItems.forEach(item => {
                    if (item.getAttribute('data-category') === category) {
                        item.click();
                    }
                });
            }
        };

        // Chatbot Voice Input
        const chatbotVoiceInput = {
            recognition: null,
            isListening: false,

            init: function() {
                if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                    return false;
                }

                const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                this.recognition = new SpeechRecognition();
                
                this.recognition.continuous = false;
                this.recognition.interimResults = false;
                this.recognition.lang = currentLanguage;

                this.recognition.onstart = () => {
                    this.isListening = true;
                    document.getElementById('voice-chat-btn').classList.add('recording');
                    document.getElementById('voice-chat-btn').innerHTML = '<i class="fas fa-microphone-slash"></i>';
                };

                this.recognition.onend = () => {
                    this.isListening = false;
                    document.getElementById('voice-chat-btn').classList.remove('recording');
                    document.getElementById('voice-chat-btn').innerHTML = '<i class="fas fa-microphone"></i>';
                };

                this.recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    document.getElementById('chatbot-input').value = transcript;
                };

                this.recognition.onerror = (event) => {
                    console.error('Chatbot voice recognition error:', event.error);
                    this.isListening = false;
                    document.getElementById('voice-chat-btn').classList.remove('recording');
                    document.getElementById('voice-chat-btn').innerHTML = '<i class="fas fa-microphone"></i>';
                };

                document.getElementById('voice-chat-btn').addEventListener('click', () => {
                    this.toggleListening();
                });

                return true;
            },

            toggleListening: function() {
                if (this.isListening) {
                    this.recognition.stop();
                } else {
                    this.recognition.lang = currentLanguage;
                    try {
                        this.recognition.start();
                    } catch (error) {
                        console.error('Error starting chatbot voice recognition:', error);
                    }
                }
            }
        };

        // Consent Management System
        const consentManager = {
            settings: {
                storage: false,
                aiTagging: false,
                voiceProcessing: false,
                analytics: false
            },
            
            init: function() {
                this.loadConsentSettings();
                this.setupConsentModal();
                this.setupPrivacyMenu();
                this.updateUI();
            },
            
            loadConsentSettings: function() {
                const saved = localStorage.getItem('empowerVaultConsent');
                if (saved) {
                    this.settings = { ...this.settings, ...JSON.parse(saved) };
                    // Hide consent modal if settings exist
                    document.getElementById('consent-modal').style.display = 'none';
                } else {
                    // Show consent modal if no settings exist
                    document.getElementById('consent-modal').style.display = 'flex';
                }
            },
            
            saveConsentSettings: function() {
                localStorage.setItem('empowerVaultConsent', JSON.stringify(this.settings));
                this.updateUI();
            },
            
            setupConsentModal: function() {
                const consentModal = document.getElementById('consent-modal');
                const acceptBtn = document.getElementById('consent-accept');
                const customizeBtn = document.getElementById('consent-customize');
                const requiredCheckbox = document.getElementById('consent-storage');
                const privacyPolicyLink = document.getElementById('privacy-policy-link');
                
                // Enable/disable accept button based on required consent
                requiredCheckbox.addEventListener('change', () => {
                    acceptBtn.disabled = !requiredCheckbox.checked;
                });
                
                // Accept all consents
                acceptBtn.addEventListener('click', () => {
                    this.settings.storage = document.getElementById('consent-storage').checked;
                    this.settings.aiTagging = document.getElementById('consent-ai-tagging').checked;
                    this.settings.voiceProcessing = document.getElementById('consent-voice-processing').checked;
                    this.settings.analytics = document.getElementById('consent-usage-analytics').checked;
                    
                    this.saveConsentSettings();
                    consentModal.style.display = 'none';
                    this.showConfirmation('Consent settings saved successfully!');
                });
                
                // Customize settings
                customizeBtn.addEventListener('click', () => {
                    // Pre-populate with current selections
                    document.getElementById('consent-ai-tagging').checked = this.settings.aiTagging;
                    document.getElementById('consent-voice-processing').checked = this.settings.voiceProcessing;
                    document.getElementById('consent-usage-analytics').checked = this.settings.analytics;
                });
                
                // Privacy policy link
                privacyPolicyLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showPrivacyPolicy();
                });
            },
            
            setupPrivacyMenu: function() {
                const privacyBtn = document.getElementById('privacy-settings-btn');
                const privacyMenu = document.getElementById('privacy-menu');
                const viewSettings = document.getElementById('view-consent-settings');
                const exportData = document.getElementById('export-data');
                const deleteData = document.getElementById('delete-data');
                
                // Toggle privacy menu
                privacyBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    privacyMenu.classList.toggle('show');
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', () => {
                    privacyMenu.classList.remove('show');
                });
                
                // View consent settings
                viewSettings.addEventListener('click', () => {
                    document.getElementById('consent-modal').style.display = 'flex';
                    privacyMenu.classList.remove('show');
                });
                
                // Export data
                exportData.addEventListener('click', () => {
                    this.exportUserData();
                    privacyMenu.classList.remove('show');
                });
                
                // Delete all data
                deleteData.addEventListener('click', () => {
                    if (confirm('Are you sure you want to delete all your data? This action cannot be undone.')) {
                        this.deleteAllData();
                        privacyMenu.classList.remove('show');
                    }
                });
            },
            
            updateUI: function() {
                // Update consent status indicator
                const statusElement = document.getElementById('consent-status');
                if (this.settings.storage) {
                    statusElement.className = 'consent-status';
                    statusElement.innerHTML = '<i class="fas fa-check-circle"></i><span data-translate="privacy_protected">Privacy Protected</span>';
                } else {
                    statusElement.className = 'consent-status revoked';
                    statusElement.innerHTML = '<i class="fas fa-exclamation-triangle"></i><span>Consent Required</span>';
                }
                
                // Update data usage transparency section
                document.getElementById('storage-status').textContent = this.settings.storage ? 'Active' : 'Inactive';
                document.getElementById('storage-status').className = `usage-status ${this.settings.storage ? 'status-active' : 'status-inactive'}`;
                
                document.getElementById('ai-status').textContent = this.settings.aiTagging ? 'Active' : 'Inactive';
                document.getElementById('ai-status').className = `usage-status ${this.settings.aiTagging ? 'status-active' : 'status-inactive'}`;
                
                document.getElementById('voice-status').textContent = this.settings.voiceProcessing ? 'Active' : 'Inactive';
                document.getElementById('voice-status').className = `usage-status ${this.settings.voiceProcessing ? 'status-active' : 'status-inactive'}`;
                
                // Enable/disable features based on consent
                this.toggleFeatures();
            },
            
            toggleFeatures: function() {
                // Example: Enable/disable AI features based on consent
                const aiFeatures = document.querySelectorAll('.ai-feature');
                aiFeatures.forEach(feature => {
                    if (this.settings.aiTagging) {
                        feature.style.opacity = '1';
                        feature.style.pointerEvents = 'auto';
                    } else {
                        feature.style.opacity = '0.5';
                        feature.style.pointerEvents = 'none';
                    }
                });
            },
            
            exportUserData: function() {
                // Get all vault data
                const vaultData = JSON.parse(localStorage.getItem('empowerVaultItems') || '[]');
                const chatHistory = JSON.parse(localStorage.getItem('empowerVaultChatHistory') || '[]');
                
                const exportData = {
                    consentSettings: this.settings,
                    vaultItems: vaultData,
                    chatHistory: chatHistory,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `empowervault-backup-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                this.showConfirmation('Data exported successfully!');
            },
            
            deleteAllData: function() {
                // Clear all local data
                localStorage.removeItem('empowerVaultConsent');
                localStorage.removeItem('empowerVaultChatHistory');
                localStorage.removeItem('empowerVaultItems');
                localStorage.removeItem('empowerVaultLanguage');
                
                // Reset vault items
                vaultItems = [];
                renderVaultItems();
                
                // Reset consent settings
                this.settings = {
                    storage: false,
                    aiTagging: false,
                    voiceProcessing: false,
                    analytics: false
                };
                
                // Reset language
                currentLanguage = 'en';
                updateLanguageDisplay();
                applyTranslations();
                
                // Show consent modal again
                document.getElementById('consent-modal').style.display = 'flex';
                
                this.showConfirmation('All data has been deleted.');
            },
            
            showConfirmation: function(message) {
                // Create a temporary confirmation message
                const confirmation = document.createElement('div');
                confirmation.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: var(--success);
                    color: white;
                    padding: 1rem 1.5rem;
                    border-radius: 8px;
                    box-shadow: var(--card-shadow);
                    z-index: 2000;
                    animation: slideInRight 0.3s ease;
                `;
                confirmation.textContent = message;
                document.body.appendChild(confirmation);
                
                setTimeout(() => {
                    confirmation.remove();
                }, 3000);
            },
            
            showPrivacyPolicy: function() {
                const policyContent = `
                    <h2>EmpowerVault Privacy Policy</h2>
                    <p><strong>Last Updated:</strong> ${new Date().toLocaleDateString()}</p>
                    
                    <h3>Data Collection and Use</h3>
                    <p>EmpowerVault is designed with privacy as a core principle. We collect minimal data necessary to provide our service:</p>
                    <ul>
                        <li><strong>Required Data:</strong> Documents, journal entries, and recordings you choose to store</li>
                        <li><strong>Optional Data:</strong> Usage patterns and feature preferences (with your consent)</li>
                        <li><strong>No External Sharing:</strong> We do not share your data with third parties</li>
                    </ul>
                    
                    <h3>Security Measures</h3>
                    <ul>
                        <li>End-to-end encryption for all stored content</li>
                        <li>Local processing of AI features (no cloud processing)</li>
                        <li>Emergency exit feature for immediate data clearance</li>
                        <li>Regular security audits and updates</li>
                    </ul>
                    
                    <h3>Your Rights</h3>
                    <ul>
                        <li>Access and download all your data at any time</li>
                        <li>Delete your account and all associated data</li>
                        <li>Modify consent preferences in settings</li>
                        <li>Export your data in standard formats</li>
                    </ul>
                    
                    <p>For questions about this policy, please contact: privacy@empowervault.app</p>
                `;
                
                alert("Privacy Policy:\n\nThis is a simplified version. In a real app, this would open a detailed policy page.");
            },
            
            // Method to check if a specific consent is given
            hasConsent: function(feature) {
                return this.settings[feature] || false;
            }
        };

        // Data storage for vault items
        let vaultItems = [];

        // Chatbot conversation storage
        let chatbotConversations = [];

        // Load vault items from localStorage
        function loadVaultItems() {
            const savedItems = localStorage.getItem('empowerVaultItems');
            if (savedItems) {
                vaultItems = JSON.parse(savedItems);
            }
        }

        // Save vault items to localStorage
        function saveVaultItems() {
            localStorage.setItem('empowerVaultItems', JSON.stringify(vaultItems));
        }

        // Load chatbot history
        function loadChatbotHistory() {
            const savedHistory = localStorage.getItem('empowerVaultChatHistory');
            if (savedHistory) {
                chatbotConversations = JSON.parse(savedHistory);
                
                // Restore conversation in UI
                chatbotConversations.forEach(conv => {
                    aiAssistant.addMessage(conv.message, conv.isUser);
                });
            }
        }

        // Render vault items to the UI
        function renderVaultItems() {
            const container = document.getElementById('vault-items-container');
            const totalItemsElement = document.getElementById('total-items');
            
            if (!container) return;
            
            container.innerHTML = '';
            totalItemsElement.textContent = vaultItems.length;
            
            if (vaultItems.length === 0) {
                container.innerHTML = `
                    <div class="vault-item" style="grid-column: 1 / -1; text-align: center; padding: 3rem;">
                        <div class="item-icon" style="margin: 0 auto 1rem;">
                            <i class="fas fa-inbox"></i>
                        </div>
                        <h4>Your vault is empty</h4>
                        <p>Start by uploading files, creating journal entries, or recording voice notes.</p>
                        <button class="btn-primary" id="empty-vault-upload" style="margin-top: 1rem;">
                            <i class="fas fa-upload"></i> Upload Your First File
                        </button>
                    </div>
                `;
                
                document.getElementById('empty-vault-upload').addEventListener('click', () => {
                    document.getElementById('upload-btn').click();
                });
                
                return;
            }
            
            vaultItems.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'vault-item';
                itemElement.innerHTML = `
                    <div class="item-icon">
                        <i class="${item.icon}"></i>
                    </div>
                    <div class="item-details">
                        <h4>${item.title}</h4>
                        <p class="item-meta">${item.date} • ${item.category}</p>
                    </div>
                    <div class="item-tags">
                        ${item.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                    </div>
                    <div class="item-actions">
                        <button class="btn-icon view-item" data-index="${index}">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn-icon download-item" data-index="${index}">
                            <i class="fas fa-download"></i>
                        </button>
                        ${item.type === 'audio' ? `<button class="btn-icon play-audio" data-index="${index}">
                            <i class="fas fa-play"></i>
                        </button>` : ''}
                        <button class="btn-icon delete-item" data-index="${index}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                container.appendChild(itemElement);
            });
            
            // Add event listeners for item actions
            document.querySelectorAll('.view-item').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.getAttribute('data-index');
                    viewVaultItem(index);
                });
            });
            
            document.querySelectorAll('.download-item').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.getAttribute('data-index');
                    downloadVaultItem(index);
                });
            });
            
            document.querySelectorAll('.play-audio').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.getAttribute('data-index');
                    playAudioItem(index);
                });
            });
            
            document.querySelectorAll('.delete-item').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = e.currentTarget.getAttribute('data-index');
                    deleteVaultItem(index);
                });
            });
        }

        // View vault item
        function viewVaultItem(index) {
            const item = vaultItems[index];
            alert(`Viewing: ${item.title}\n\nType: ${item.type}\nCategory: ${item.category}\nDate: ${item.date}\nTags: ${item.tags.join(', ')}`);
        }

        // Download vault item
        function downloadVaultItem(index) {
            const item = vaultItems[index];
            
            // In a real app, this would download the actual file
            // For this demo, we'll create a mock download
            const element = document.createElement('a');
            const file = new Blob([`This is a mock download of: ${item.title}`], {type: 'text/plain'});
            element.href = URL.createObjectURL(file);
            element.download = `${item.title}.txt`;
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            
            aiAssistant.addMessage(`I've prepared the download for "${item.title}". Your file is now being downloaded.`);
        }

        // Play audio item
        function playAudioItem(index) {
            const item = vaultItems[index];
            if (item.type === 'audio' && item.audioUrl) {
                // In a real app, this would play the actual audio
                alert(`Playing audio: ${item.title}\n\nThis is a simulation. In the full app, the actual audio would play.`);
            }
        }

        // Delete vault item
        function deleteVaultItem(index) {
            if (confirm('Are you sure you want to delete this item? This action cannot be undone.')) {
                vaultItems.splice(index, 1);
                saveVaultItems();
                renderVaultItems();
                aiAssistant.addMessage("I've removed that item from your vault. It's been permanently deleted.");
            }
        }

        // Filter vault items by category
        function filterByCategory(category) {
            const categoryItems = document.querySelectorAll('.vault-categories li');
            categoryItems.forEach(item => {
                if (item.getAttribute('data-category') === category) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // In a real app, this would filter the displayed items
            // For this demo, we'll just show a message
            if (category === 'all') {
                aiAssistant.addMessage("Showing all items in your vault.");
            } else {
                aiAssistant.addMessage(`Showing ${category} items. I've filtered your vault to show only these documents.`);
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize language functionality
            initLanguageDropdown();
            loadLanguagePreference();
            
            // Initialize consent manager
            consentManager.init();
            
            // Initialize voice navigation
            voiceNavigation.init();
            
            // Initialize voice-to-text
            voiceToTextManager.init();
            
            // Initialize chatbot voice input
            chatbotVoiceInput.init();
            
            // Load saved data
            loadVaultItems();
            loadChatbotHistory();
            
            // DOM Elements
            const uploadBtn = document.getElementById('upload-btn');
            const uploadModal = document.getElementById('upload-modal');
            const cancelUpload = document.getElementById('cancel-upload');
            const confirmUpload = document.getElementById('confirm-upload');
            const fileUpload = document.getElementById('file-upload');
            const uploadFileOption = document.getElementById('upload-file');
            const recordAudioOption = document.getElementById('record-audio');
            const createDocOption = document.getElementById('create-doc');
            const newJournalBtn = document.getElementById('new-journal');
            const journalModal = document.getElementById('journal-modal');
            const cancelJournal = document.getElementById('cancel-journal');
            const saveJournal = document.getElementById('save-journal');
            const voiceModal = document.getElementById('voice-modal');
            const cancelVoice = document.getElementById('cancel-voice');
            const saveVoice = document.getElementById('save-voice');
            const searchInput = document.getElementById('search-input');
            const searchBtn = document.getElementById('search-btn');
            const vaultItemsContainer = document.getElementById('vault-items-container');
            const totalItemsElement = document.getElementById('total-items');
            const emergencyExitBtn = document.getElementById('emergency-exit-btn');
            const aiChatbotToggle = document.getElementById('ai-chatbot-toggle');
            const aiChatbot = document.getElementById('ai-chatbot');
            const closeChatbot = document.getElementById('close-chatbot');
            const sendMessageBtn = document.getElementById('send-message');
            const chatbotInput = document.getElementById('chatbot-input');
            const chatbotMessages = document.getElementById('chatbot-messages');
            const quickUploadHelp = document.getElementById('quick-upload-help');
            const voiceChatBtn = document.getElementById('voice-chat-btn');
            const uploadProgress = document.getElementById('upload-progress');
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            
            // Voice-to-text elements
            const startVoiceInput = document.getElementById('start-voice-input');
            const applyTranscript = document.getElementById('apply-transcript');
            const cancelTranscript = document.getElementById('cancel-transcript');
            const translateContent = document.getElementById('translate-content');
            
            // Voice recording elements
            const startRecordingBtn = document.getElementById('start-recording');
            const stopRecordingBtn = document.getElementById('stop-recording');
            const playRecordingBtn = document.getElementById('play-recording');
            const recordingIndicator = document.getElementById('recording-indicator');
            const recordingTimer = document.getElementById('recording-timer');
            const audioPlayer = document.getElementById('audio-player');
            const recordedAudio = document.getElementById('recorded-audio');
            
            // Voice recording variables
            let mediaRecorder;
            let audioChunks = [];
            let recordingInterval;
            let recordingSeconds = 0;
            let audioBlob = null;

            // Initialize the vault with existing items
            renderVaultItems();

            // Voice-to-text event listeners
            startVoiceInput.addEventListener('click', () => {
                voiceToTextManager.toggleListening();
            });

            applyTranscript.addEventListener('click', () => {
                voiceToTextManager.applyTranscript();
            });

            cancelTranscript.addEventListener('click', () => {
                voiceToTextManager.cancelTranscript();
            });

            translateContent.addEventListener('click', () => {
                // Translation functionality would be implemented here
                alert('Translation feature would be implemented with a translation API');
            });

            // Upload functionality
            uploadBtn.addEventListener('click', function() {
                if (!consentManager.hasConsent('storage')) {
                    alert('Please accept the required consent to use EmpowerVault.');
                    document.getElementById('consent-modal').style.display = 'flex';
                    return;
                }
                uploadModal.style.display = 'flex';
            });

            uploadFileOption.addEventListener('click', function() {
                fileUpload.click();
            });

            fileUpload.addEventListener('change', function() {
                if (this.files.length > 0) {
                    confirmUpload.disabled = false;
                }
            });

            recordAudioOption.addEventListener('click', function() {
                uploadModal.style.display = 'none';
                voiceModal.style.display = 'flex';
            });

            createDocOption.addEventListener('click', function() {
                uploadModal.style.display = 'none';
                journalModal.style.display = 'flex';
            });

            cancelUpload.addEventListener('click', function() {
                uploadModal.style.display = 'none';
                fileUpload.value = '';
                confirmUpload.disabled = true;
            });

            confirmUpload.addEventListener('click', function() {
                // Simulate upload process
                uploadProgress.style.display = 'block';
                let progress = 0;
                
                const uploadInterval = setInterval(() => {
                    progress += 5;
                    progressFill.style.width = `${progress}%`;
                    progressText.textContent = `Uploading... ${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(uploadInterval);
                        
                        // Create a new vault item
                        const newItem = {
                            id: Date.now(),
                            title: fileUpload.files[0].name,
                            type: 'document',
                            category: 'other',
                            date: new Date().toLocaleDateString(),
                            tags: ['uploaded', 'new'],
                            icon: 'fas fa-file'
                        };
                        
                        vaultItems.push(newItem);
                        saveVaultItems();
                        renderVaultItems();
                        
                        progressText.textContent = 'Upload complete!';
                        
                        setTimeout(() => {
                            uploadModal.style.display = 'none';
                            uploadProgress.style.display = 'none';
                            progressFill.style.width = '0%';
                            fileUpload.value = '';
                            confirmUpload.disabled = true;
                            
                            aiAssistant.addMessage(`I've successfully uploaded "${newItem.title}" to your vault. It's now securely stored with military-grade encryption.`);
                        }, 1000);
                    }
                }, 100);
            });

            // Journal functionality
            newJournalBtn.addEventListener('click', function() {
                if (!consentManager.hasConsent('storage')) {
                    alert('Please accept the required consent to use EmpowerVault.');
                    document.getElementById('consent-modal').style.display = 'flex';
                    return;
                }
                journalModal.style.display = 'flex';
            });

            cancelJournal.addEventListener('click', function() {
                journalModal.style.display = 'none';
                document.getElementById('journal-title').value = '';
                document.getElementById('journal-content').value = '';
                document.getElementById('journal-tags').value = '';
                voiceToTextManager.cancelTranscript();
            });

            saveJournal.addEventListener('click', function() {
                const title = document.getElementById('journal-title').value;
                const content = document.getElementById('journal-content').value;
                const tags = document.getElementById('journal-tags').value.split(',').map(tag => tag.trim());
                
                if (!title || !content) {
                    alert('Please provide both a title and content for your journal entry.');
                    return;
                }
                
                // Create a new journal item
                const newItem = {
                    id: Date.now(),
                    title: title,
                    type: 'journal',
                    category: 'journal',
                    date: new Date().toLocaleDateString(),
                    tags: ['journal', 'personal', ...tags],
                    icon: 'fas fa-book-open',
                    content: content
                };
                
                vaultItems.push(newItem);
                saveVaultItems();
                renderVaultItems();
                
                journalModal.style.display = 'none';
                document.getElementById('journal-title').value = '';
                document.getElementById('journal-content').value = '';
                document.getElementById('journal-tags').value = '';
                
                aiAssistant.addMessage(`I've saved your journal entry "${title}". Your thoughts are now securely stored in your vault. Thank you for sharing.`);
            });

            // Voice recording functionality
            let audioStream = null;

            startRecordingBtn.addEventListener('click', async function() {
                try {
                    audioStream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(audioStream);
                    audioChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };
                    
                    mediaRecorder.onstop = () => {
                        audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        const audioUrl = URL.createObjectURL(audioBlob);
                        recordedAudio.src = audioUrl;
                        audioPlayer.style.display = 'block';
                        saveVoice.disabled = false;
                    };
                    
                    mediaRecorder.start();
                    startRecordingBtn.disabled = true;
                    stopRecordingBtn.disabled = false;
                    recordingIndicator.style.display = 'flex';
                    
                    // Start timer
                    recordingSeconds = 0;
                    recordingInterval = setInterval(() => {
                        recordingSeconds++;
                        const minutes = Math.floor(recordingSeconds / 60);
                        const seconds = recordingSeconds % 60;
                        recordingTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    }, 1000);
                    
                } catch (error) {
                    console.error('Error accessing microphone:', error);
                    alert('Unable to access microphone. Please check your permissions and try again.');
                }
            });

            stopRecordingBtn.addEventListener('click', function() {
                if (mediaRecorder && mediaRecorder.state === 'recording') {
                    mediaRecorder.stop();
                    audioStream.getTracks().forEach(track => track.stop());
                    
                    startRecordingBtn.disabled = false;
                    stopRecordingBtn.disabled = true;
                    playRecordingBtn.disabled = false;
                    recordingIndicator.style.display = 'none';
                    
                    clearInterval(recordingInterval);
                }
            });

            playRecordingBtn.addEventListener('click', function() {
                recordedAudio.play();
            });

            cancelVoice.addEventListener('click', function() {
                voiceModal.style.display = 'none';
                document.getElementById('voice-title').value = '';
                document.getElementById('voice-tags').value = '';
                
                if (mediaRecorder && mediaRecorder.state === 'recording') {
                    mediaRecorder.stop();
                    audioStream.getTracks().forEach(track => track.stop());
                }
                
                recordingIndicator.style.display = 'none';
                audioPlayer.style.display = 'none';
                clearInterval(recordingInterval);
                recordingTimer.textContent = '00:00';
            });

            saveVoice.addEventListener('click', function() {
                const title = document.getElementById('voice-title').value;
                const tags = document.getElementById('voice-tags').value.split(',').map(tag => tag.trim());
                
                if (!title) {
                    alert('Please provide a title for your voice journal.');
                    return;
                }
                
                // Create a new voice journal item
                const newItem = {
                    id: Date.now(),
                    title: title,
                    type: 'audio',
                    category: 'audio',
                    date: new Date().toLocaleDateString(),
                    tags: ['audio', 'voice', ...tags],
                    icon: 'fas fa-microphone',
                    audioUrl: URL.createObjectURL(audioBlob)
                };
                
                vaultItems.push(newItem);
                saveVaultItems();
                renderVaultItems();
                
                voiceModal.style.display = 'none';
                document.getElementById('voice-title').value = '';
                document.getElementById('voice-tags').value = '';
                audioPlayer.style.display = 'none';
                saveVoice.disabled = true;
                playRecordingBtn.disabled = true;
                recordingTimer.textContent = '00:00';
                
                aiAssistant.addMessage(`I've saved your voice journal "${title}". Your recording is now securely stored in your vault.`);
            });

            // Search functionality
            searchBtn.addEventListener('click', function() {
                performSearch();
            });

            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            function performSearch() {
                const query = searchInput.value.toLowerCase().trim();
                if (query) {
                    aiAssistant.addMessage(`Searching for "${query}" in your vault...`);
                    // In a real app, this would filter vault items
                    // For this demo, we'll just show a message
                    setTimeout(() => {
                        aiAssistant.addMessage(`I found several items related to "${query}" in your vault.`);
                    }, 1000);
                }
            }

            // Category filtering
            document.querySelectorAll('.vault-categories li').forEach(item => {
                item.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    filterByCategory(category);
                });
            });

            // Tag filtering
            document.querySelectorAll('.tag').forEach(tag => {
                tag.addEventListener('click', function() {
                    const tagName = this.getAttribute('data-tag');
                    aiAssistant.addMessage(`Showing items tagged with "${tagName}".`);
                    // In a real app, this would filter by tag
                });
            });

            // AI Chatbot functionality
            aiChatbotToggle.addEventListener('click', function() {
                aiChatbot.style.display = aiChatbot.style.display === 'none' ? 'flex' : 'none';
            });

            closeChatbot.addEventListener('click', function() {
                aiChatbot.style.display = 'none';
            });

            sendMessageBtn.addEventListener('click', function() {
                const message = chatbotInput.value.trim();
                if (message) {
                    aiAssistant.processUserMessage(message);
                    chatbotInput.value = '';
                }
            });

            chatbotInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessageBtn.click();
                }
            });

            quickUploadHelp.addEventListener('click', function() {
                aiAssistant.processUserMessage('help with upload');
            });

            // Quick action buttons in initial message
            document.querySelectorAll('.quick-action-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.getAttribute('data-action');
                    aiAssistant.handleQuickAction(this.textContent);
                });
            });

            // Emergency exit
            emergencyExitBtn.addEventListener('click', function(e) {
                if (!confirm('Are you sure you want to use the emergency exit? This will immediately close the app and clear your browser history.')) {
                    e.preventDefault();
                }
            });

            // Initialize with some sample data if empty
            if (vaultItems.length === 0) {
                // Add a welcome journal entry
                vaultItems.push({
                    id: 1,
                    title: 'Welcome to EmpowerVault',
                    type: 'journal',
                    category: 'journal',
                    date: new Date().toLocaleDateString(),
                    tags: ['welcome', 'getting-started'],
                    icon: 'fas fa-book-open',
                    content: 'This is your secure space for documents, journals, and recordings. Everything is encrypted and only you have access.'
                });
                
                saveVaultItems();
                renderVaultItems();
            }
            
            // Enable all features by default for demo purposes
            document.getElementById('consent-ai-tagging').checked = true;
            document.getElementById('consent-voice-processing').checked = true;
            document.getElementById('consent-usage-analytics').checked = true;
            
            // Update UI to show all features as active
            document.getElementById('ai-status').textContent = 'Active';
            document.getElementById('ai-status').className = 'usage-status status-active';
            document.getElementById('voice-status').textContent = 'Active';
            document.getElementById('voice-status').className = 'usage-status status-active';
        });
    </script>
</body>
</html>