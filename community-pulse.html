<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeSpace - Community Safety Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
            --primary: #6C63FF;
            --primary-light: #8E85FF;
            --primary-dark: #5B52EE;
            --secondary: #FF6584;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --text: #333333;
            --text-light: #666666;
            --text-lighter: #999999;
            --bg: #f8f9fa;
            --card-bg: #ffffff;
            --border: #e0e0e0;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
            --incidents: #FF9800;
            --responders: #4CAF50;
            --transparency: #2196F3;
            --security: #9C27B0;
            --chat: #00BCD4;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        *:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .emergency-exit {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }

        .btn-emergency {
            background: var(--danger);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .btn-emergency:hover {
            background: #d32f2f;
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: var(--card-bg);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .app-header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .btn-icon {
            background: none;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text);
            transition: all 0.3s ease;
        }

        .btn-icon:hover {
            background-color: rgba(108, 99, 255, 0.1);
            color: var(--primary);
        }

        .community-container {
            padding: 30px;
            min-height: 100vh;
            max-width: 1200px;
            margin: 0 auto;
        }

        .community-intro {
            margin-bottom: 40px;
            text-align: center;
        }

        .community-intro h2 {
            font-size: 2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .community-intro p {
            font-size: 1.1rem;
            color: var(--text-light);
            max-width: 800px;
            margin: 0 auto;
        }

        .community-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .feature-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
        }

        .feature-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
        }

        .feature-card i {
            font-size: 3rem;
            margin-bottom: 20px;
            transition: transform 0.3s ease;
        }

        .feature-card:hover i {
            transform: scale(1.1);
        }

        .feature-card h3 {
            margin: 0 0 15px 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .feature-card p {
            margin: 0 0 20px 0;
            color: var(--text-light);
            font-size: 1rem;
        }

        .btn-feature {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-feature:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .feature-card.incidents::before {
            background: var(--incidents);
        }

        .feature-card.incidents i {
            color: var(--incidents);
        }

        .feature-card.incidents .btn-feature {
            background: var(--incidents);
        }

        .feature-card.incidents .btn-feature:hover {
            background: #F57C00;
        }

        .feature-card.chat::before {
            background: var(--chat);
        }

        .feature-card.chat i {
            color: var(--chat);
        }

        .feature-card.chat .btn-feature {
            background: var(--chat);
        }

        .feature-card.chat .btn-feature:hover {
            background: #0097A7;
        }

        .feature-card.responders::before {
            background: var(--responders);
        }

        .feature-card.responders i {
            color: var(--responders);
        }

        .feature-card.responders .btn-feature {
            background: var(--responders);
        }

        .feature-card.responders .btn-feature:hover {
            background: #388E3C;
        }

        .feature-card.transparency::before {
            background: var(--transparency);
        }

        .feature-card.transparency i {
            color: var(--transparency);
        }

        .feature-card.transparency .btn-feature {
            background: var(--transparency);
        }

        .feature-card.transparency .btn-feature:hover {
            background: #1976D2;
        }

        .feature-card.security::before {
            background: var(--security);
        }

        .feature-card.security i {
            color: var(--security);
        }

        .feature-card.security .btn-feature {
            background: var(--security);
        }

        .feature-card.security .btn-feature:hover {
            background: #7B1FA2;
        }

        .safety-heatmap {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .heatmap-container {
            width: 100%;
            height: 500px;
            background: #e9ecef;
            border-radius: 12px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .heatmap-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .incident-reporting {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .report-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--bg);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .location-map {
            width: 100%;
            height: 300px;
            border-radius: 12px;
            margin: 15px 0;
            border: 1px solid var(--border);
        }

        .consent-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 20px 0;
        }

        .consent-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .consent-item input[type="checkbox"] {
            margin-top: 3px;
        }

        .consent-item label {
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .community-chat {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 20px;
        }

        .chat-header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--bg);
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 15px;
            border-radius: 18px;
            max-width: 80%;
            position: relative;
        }

        .message.anonymous {
            background: var(--primary-light);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .message.user {
            background: var(--primary);
            color: white;
            align-self: flex-end;
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        .message-meta {
            font-size: 0.7rem;
            margin-top: 5px;
            opacity: 0.7;
        }

        .chat-input-area {
            display: flex;
            padding: 15px;
            background: white;
            border-top: 1px solid var(--border);
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 24px;
            margin-right: 10px;
        }

        .send-button {
            background: var(--primary);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .anonymity-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        .responder-network {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .responders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .responder-card {
            background: var(--bg);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .responder-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .responder-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 15px;
        }

        .responder-badge {
            background: var(--success);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin: 10px 0;
            display: inline-block;
        }

        .transparency-dashboard {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .metric-card {
            background: var(--bg);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .metric-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .improvement-badge {
            background: var(--success);
            color: white;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.8rem;
            margin-left: 8px;
        }

        .security-privacy {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: var(--shadow);
        }

        .security-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .security-card {
            background: var(--bg);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .security-card i {
            font-size: 2.5rem;
            color: var(--security);
            margin-bottom: 15px;
        }

        .audit-log {
            background: var(--bg);
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            max-height: 300px;
            overflow-y: auto;
        }

        .audit-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border);
        }

        .audit-item:last-child {
            border-bottom: none;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text);
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 10000;
            max-width: 300px;
            animation: slideInUp 0.3s ease;
        }

        @keyframes slideInUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideOutDown {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(100%); opacity: 0; }
        }

        .section-nav {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .nav-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: var(--primary-dark);
        }

        .nav-btn.active {
            background: var(--primary-dark);
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary);
        }

        @media (max-width: 768px) {
            .community-container {
                padding: 20px 15px;
            }
            
            .community-features {
                grid-template-columns: 1fr;
            }
            
            .report-form {
                grid-template-columns: 1fr;
            }
            
            .responders-grid {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .section-nav {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 480px) {
            .app-header h1 {
                font-size: 1.3rem;
            }
            
            .community-intro h2 {
                font-size: 1.7rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="trauma-informed">
    <!-- Emergency Exit -->
    <div class="emergency-exit">
        <a href="https://www.google.com" class="btn-emergency">
            <i class="fas fa-running"></i> Exit Quickly
        </a>
    </div>

    <!-- App Header -->
    <header class="app-header">
        <h1>SafeSpace - Community Safety Platform</h1>
        <div class="user-actions">
            <button class="btn-icon" id="notifications-btn" aria-label="Notifications">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notification-badge" style="display: none;">3</span>
            </button>
            <div class="user-avatar" id="user-menu-toggle" aria-label="User menu" tabindex="0" role="button">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="community-container">
        <!-- Welcome Section -->
        <section class="community-intro">
            <h2>Community Safety & Trust-Building</h2>
            <p>Working together to create safer communities through transparency, collaboration, and collective responsibility.</p>
        </section>

        <!-- Navigation -->
        <div class="section-nav">
            <button class="nav-btn active" data-section="dashboard">Dashboard</button>
            <button class="nav-btn" data-section="incidents">Incident Reporting</button>
            <button class="nav-btn" data-section="chat">Community Chat</button>
            <button class="nav-btn" data-section="responders">Responders</button>
            <button class="nav-btn" data-section="transparency">Transparency</button>
            <button class="nav-btn" data-section="security">Security</button>
        </div>

        <!-- Dashboard Section -->
        <section id="dashboard" class="dashboard-section">
            <div class="community-features">
                <div class="feature-card incidents" data-section="incidents">
                    <i class="fas fa-map-marked-alt" aria-hidden="true"></i>
                    <h3>Incident Reporting & Threat Map</h3>
                    <p>Anonymously report safety concerns and view real-time community safety patterns</p>
                    <button class="btn-feature">
                        <i class="fas fa-plus" aria-hidden="true"></i> Report Incident
                    </button>
                </div>
                
                <div class="feature-card chat" data-section="chat">
                    <i class="fas fa-comments" aria-hidden="true"></i>
                    <h3>Community Chat</h3>
                    <p>Connect with community members and share safety information anonymously</p>
                    <button class="btn-feature">
                        <i class="fas fa-comment" aria-hidden="true"></i> Join Chat
                    </button>
                </div>
                
                <div class="feature-card responders" data-section="responders">
                    <i class="fas fa-users" aria-hidden="true"></i>
                    <h3>Verified Responder Network</h3>
                    <p>Connect with trained community responders and support services</p>
                    <button class="btn-feature">
                        <i class="fas fa-search" aria-hidden="true"></i> Find Responders
                    </button>
                </div>
                
                <div class="feature-card transparency" data-section="transparency">
                    <i class="fas fa-chart-line" aria-hidden="true"></i>
                    <h3>Transparency Dashboard</h3>
                    <p>View performance data and safety improvements in your community</p>
                    <button class="btn-feature">
                        <i class="fas fa-chart-bar" aria-hidden="true"></i> View Dashboard
                    </button>
                </div>

                <div class="feature-card security" data-section="security">
                    <i class="fas fa-shield-alt" aria-hidden="true"></i>
                    <h3>Security & Privacy</h3>
                    <p>Learn about our data protection measures and privacy guarantees</p>
                    <button class="btn-feature">
                        <i class="fas fa-lock" aria-hidden="true"></i> View Security
                    </button>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="safety-heatmap">
                <h3>Recent Community Activity</h3>
                <p>Stay informed about recent safety reports and community updates.</p>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-value" id="recent-incidents">12</div>
                        <div class="metric-label">Incidents This Week</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="active-responders">8</div>
                        <div class="metric-label">Active Responders</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="response-time">14 min</div>
                        <div class="metric-label">Avg Response Time</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" id="community-members">142</div>
                        <div class="metric-label">Community Members</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Safety Heat Map Section -->
        <section id="incidents" class="safety-heatmap" style="display: none;">
            <h3>Community Safety Threat Map</h3>
            <p>Real-time incident reports help identify safety patterns and drive community improvements.</p>
            
            <div class="heatmap-container" id="heatmap-visualization">
                <!-- Real map will be loaded here -->
            </div>
            
            <div class="heatmap-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #4CAF50;"></div>
                    <span>Safe Area</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFC107;"></div>
                    <span>Moderate Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FF9800;"></div>
                    <span>High Risk</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #F44336;"></div>
                    <span>Very High Risk</span>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn-feature" id="report-incident-btn">
                    <i class="fas fa-plus"></i> Report New Incident
                </button>
            </div>
        </section>

        <!-- Incident Reporting Section -->
        <section id="incident-reporting" class="incident-reporting" style="display: none;">
            <h3>Anonymous Incident Report</h3>
            <p>Help make your community safer by reporting non-emergency safety concerns. All reports are completely anonymous.</p>
            
            <form id="report-form" class="report-form">
                <div class="form-group">
                    <label for="incident-type">Type of Incident</label>
                    <select id="incident-type" required>
                        <option value="">Select incident type</option>
                        <option value="harassment">Verbal Harassment</option>
                        <option value="catcalling">Catcalling</option>
                        <option value="lighting">Poor Street Lighting</option>
                        <option value="suspicious">Suspicious Activity</option>
                        <option value="theft">Theft/Burglary</option>
                        <option value="vandalism">Vandalism</option>
                        <option value="other">Other Safety Concern</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="incident-date">Date of Incident</label>
                    <input type="date" id="incident-date" required>
                </div>
                
                <div class="form-group">
                    <label for="incident-time">Approximate Time</label>
                    <input type="time" id="incident-time" required>
                </div>
                
                <div class="form-group full-width">
                    <label for="incident-location">Location</label>
                    <div class="location-map" id="incident-location-map"></div>
                    <small>Click on the map to mark the incident location. Your exact location is never stored.</small>
                </div>
                
                <div class="form-group full-width">
                    <label for="incident-description">Description (Optional)</label>
                    <textarea id="incident-description" placeholder="Brief description of what happened..."></textarea>
                </div>
                
                <div class="form-group full-width">
                    <div class="consent-options">
                        <h4>Data Consent Options</h4>
                        <div class="consent-item">
                            <input type="checkbox" id="consent-anonymous" checked>
                            <label for="consent-anonymous">Report anonymously (recommended)</label>
                        </div>
                        <div class="consent-item">
                            <input type="checkbox" id="consent-aggregate">
                            <label for="consent-aggregate">Allow my report to be included in community safety statistics</label>
                        </div>
                        <div class="consent-item">
                            <input type="checkbox" id="consent-contact">
                            <label for="consent-contact">Allow community responders to contact me (not anonymous)</label>
                        </div>
                        <div class="consent-item">
                            <input type="checkbox" id="consent-storage" required>
                            <label for="consent-storage">I understand my data will be stored securely for 30 days</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group full-width" style="text-align: center;">
                    <button type="submit" class="btn-feature">
                        <i class="fas fa-paper-plane"></i> Submit Report
                    </button>
                </div>
            </form>
        </section>

        <!-- Community Chat Section -->
        <section id="chat" class="community-chat" style="display: none;">
            <h3>Community Safety Chat</h3>
            <p>Connect with community members to share safety information and support each other.</p>
            
            <div class="chat-container">
                <div class="chat-header">
                    <div>
                        <h4>Community Safety Chat</h4>
                        <small>All messages are end-to-end encrypted</small>
                    </div>
                    <div class="online-indicator">
                        <i class="fas fa-circle" style="color: #4CAF50;"></i>
                        <span id="online-count">12 online</span>
                    </div>
                </div>
                
                <div class="chat-messages" id="chat-messages">
                    <!-- Messages will be populated by JavaScript -->
                </div>
                
                <div class="chat-input-area">
                    <input type="text" class="chat-input" id="chat-input" placeholder="Type your message...">
                    <button class="send-button" id="send-message">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                
                <div class="anonymity-toggle">
                    <input type="checkbox" id="anonymous-chat" checked>
                    <label for="anonymous-chat">Post anonymously as "Community Member"</label>
                </div>
            </div>
            
            <div style="margin-top: 20px; background: var(--bg); padding: 15px; border-radius: 8px;">
                <h4>Chat Guidelines</h4>
                <ul style="font-size: 0.9rem; margin-top: 10px;">
                    <li>Be respectful and supportive of all community members</li>
                    <li>Do not share personal identifying information</li>
                    <li>Report emergencies directly to authorities, not in this chat</li>
                    <li>All messages are encrypted and stored for 7 days only</li>
                </ul>
            </div>
        </section>

        <!-- Responder Network Section -->
        <section id="responders" class="responder-network" style="display: none;">
            <h3>Verified Local Responder Network</h3>
            <p>Connect with trained and vetted community responders who can provide support and assistance.</p>
            
            <div class="responders-grid" id="responders-grid">
                <!-- Responders will be populated by JavaScript -->
            </div>
        </section>

        <!-- Transparency Dashboard Section -->
        <section id="transparency" class="transparency-dashboard" style="display: none;">
            <h3>Community Safety Transparency Dashboard</h3>
            <p>See how reported incidents lead to tangible safety improvements in your community.</p>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">87%</div>
                    <div class="metric-label">Incidents Addressed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">12 min</div>
                    <div class="metric-label">Avg Response Time <span class="improvement-badge">-3 min</span></div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">45</div>
                    <div class="metric-label">New Street Lights Installed</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">92%</div>
                    <div class="metric-label">Community Satisfaction</div>
                </div>
            </div>
            
            <h4 style="margin-top: 30px;">Recent Safety Improvements</h4>
            <div style="background: var(--bg); padding: 20px; border-radius: 12px; margin-top: 15px;">
                <ul style="list-style: none;">
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--border);">
                        <strong>New Lighting Installed</strong> - 15 new street lights added in CBD based on community reports
                    </li>
                    <li style="padding: 10px 0; border-bottom: 1px solid var(--border);">
                        <strong>Increased Patrols</strong> - SAPS increased visibility in residential areas by 40%
                    </li>
                    <li style="padding: 10px 0;">
                        <strong>Community Watch Training</strong> - 25 new community responders trained and verified
                    </li>
                </ul>
            </div>
        </section>

        <!-- Security & Privacy Section -->
        <section id="security" class="security-privacy" style="display: none;">
            <h3>Security & Privacy Guarantees</h3>
            <p>Your safety and privacy are our highest priorities. Learn about our comprehensive protection measures.</p>
            
            <div class="security-features">
                <div class="security-card">
                    <i class="fas fa-lock"></i>
                    <h4>End-to-End Encryption</h4>
                    <p>All your data is encrypted and secure</p>
                </div>
                <div class="security-card">
                    <i class="fas fa-eye-slash"></i>
                    <h4>Anonymous Reporting</h4>
                    <p>No personal information collected in reports</p>
                </div>
                <div class="security-card">
                    <i class="fas fa-ban"></i>
                    <h4>No Data Selling</h4>
                    <p>We never sell or share your data with third parties</p>
                </div>
                <div class="security-card">
                    <i class="fas fa-history"></i>
                    <h4>Data Access Logs</h4>
                    <p>Full transparency on how your data is used</p>
                </div>
            </div>
            
            <h4 style="margin-top: 30px;">Data Access Audit Trail</h4>
            <div class="audit-log" id="audit-log">
                <!-- Audit trail will be populated by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Responder Contact Modal -->
    <div id="responder-modal" class="modal" role="dialog" aria-modal="true">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="responder-modal-title">Contact Responder</h3>
                <button class="close-modal" id="close-responder-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="responder-modal-content">
                <!-- Modal content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Community Safety Platform Implementation
        document.addEventListener('DOMContentLoaded', function() {
            // State management
            let currentSection = 'dashboard';
            let incidentReports = [];
            let auditTrail = [];
            let chatMessages = [];
            let locationMap = null;
            let threatMap = null;
            let selectedLocation = null;
            let mapMarkers = [];
            let onlineUsers = 12;

            // Sample data
            const responders = [
                {
                    id: 1,
                    name: "Community Safety Patrol",
                    type: "neighborhood-watch",
                    area: "CBD & Surrounds",
                    availability: "24/7",
                    contact: "patrol@safety.org.za",
                    verified: true,
                    training: "Advanced Community Safety",
                    responseTime: "5-10 min"
                },
                {
                    id: 2,
                    name: "GBV Support Advocates",
                    type: "counseling",
                    area: "Metro Wide",
                    availability: "Mon-Fri 8am-8pm",
                    contact: "support@gbvhelp.org.za",
                    verified: true,
                    training: "Trauma-Informed Counseling",
                    responseTime: "24-48 hours"
                },
                {
                    id: 3,
                    name: "Legal Aid Volunteers",
                    type: "legal",
                    area: "All Districts",
                    availability: "Mon-Fri 9am-5pm",
                    contact: "legal@communitylaw.org.za",
                    verified: true,
                    training: "Legal Rights & Protection Orders",
                    responseTime: "2-3 business days"
                },
                {
                    id: 4,
                    name: "Emergency Response Team",
                    type: "first-responder",
                    area: "Rapid Response Zone",
                    availability: "24/7 Emergency",
                    contact: "emergency@response.org.za",
                    verified: true,
                    training: "Emergency First Response",
                    responseTime: "Under 10 min"
                }
            ];

            // Sample incident data for initial map
            const sampleIncidents = [
                { 
                    id: 1,
                    type: "harassment", 
                    lat: -26.2041, 
                    lng: 28.0473, 
                    date: "2024-01-15", 
                    time: "18:30", 
                    severity: "high",
                    description: "Verbal harassment reported by multiple community members"
                },
                { 
                    id: 2,
                    type: "lighting", 
                    lat: -26.1941, 
                    lng: 28.0373, 
                    date: "2024-01-14", 
                    time: "20:15", 
                    severity: "moderate",
                    description: "Poor lighting making area feel unsafe after dark"
                },
                { 
                    id: 3,
                    type: "catcalling", 
                    lat: -26.2141, 
                    lng: 28.0573, 
                    date: "2024-01-13", 
                    time: "17:45", 
                    severity: "high",
                    description: "Multiple incidents of catcalling reported"
                },
                { 
                    id: 4,
                    type: "suspicious", 
                    lat: -26.2241, 
                    lng: 28.0273, 
                    date: "2024-01-12", 
                    time: "21:00", 
                    severity: "moderate",
                    description: "Suspicious individuals loitering in the area"
                }
            ];

            // Sample chat messages
            const sampleChatMessages = [
                { 
                    id: 1, 
                    user: "Community Member", 
                    message: "Has anyone noticed the new street lights on Oak Avenue? They're much brighter now!", 
                    timestamp: new Date(Date.now() - 3600000), 
                    anonymous: true 
                },
                { 
                    id: 2, 
                    user: "Safety Advocate", 
                    message: "Yes! This was a direct result of community reporting. Keep those reports coming!", 
                    timestamp: new Date(Date.now() - 3300000), 
                    anonymous: false 
                },
                { 
                    id: 3, 
                    user: "Community Member", 
                    message: "The community watch patrols have been more visible in the evenings. Feeling safer already.", 
                    timestamp: new Date(Date.now() - 1800000), 
                    anonymous: true 
                },
                { 
                    id: 4, 
                    user: "Community Member", 
                    message: "Reminder: The self-defense workshop is this Saturday at the community center. Free for all residents.", 
                    timestamp: new Date(Date.now() - 900000), 
                    anonymous: true 
                }
            ];

            // Initialize features
            initializeCommunityFeatures();

            function initializeCommunityFeatures() {
                console.log('Initializing community safety platform...');
                
                // Set up event listeners
                setupEventListeners();
                
                // Load initial data
                loadResponders();
                loadAuditTrail();
                loadChatMessages();
                
                // Add sample incidents
                incidentReports = [...sampleIncidents];
                
                // Initialize dashboard metrics
                updateDashboardMetrics();
                
                // Show notification badge
                document.getElementById('notification-badge').style.display = 'flex';
                
                // Initialize maps when needed
                document.getElementById('report-incident-btn').addEventListener('click', function() {
                    showSection('incident-reporting');
                    if (!locationMap) {
                        setTimeout(initializeLocationMap, 100);
                    }
                });
                
                // Feature cards navigation
                document.querySelectorAll('.feature-card').forEach(card => {
                    card.addEventListener('click', function() {
                        const section = this.getAttribute('data-section');
                        showSection(section);
                    });
                });
            }

            function setupEventListeners() {
                // Navigation buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const section = this.getAttribute('data-section');
                        showSection(section);
                    });
                });

                // Incident reporting form
                document.getElementById('report-form').addEventListener('submit', handleIncidentReport);

                // Chat functionality
                document.getElementById('send-message').addEventListener('click', sendChatMessage);
                document.getElementById('chat-input').addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });

                // Modal controls
                document.getElementById('close-responder-modal').addEventListener('click', closeResponderModal);
                document.getElementById('responder-modal').addEventListener('click', function(e) {
                    if (e.target === this) closeResponderModal();
                });
            }

            function showSection(sectionId) {
                // Update navigation
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-section') === sectionId) {
                        btn.classList.add('active');
                    }
                });
                
                // Hide all sections
                document.querySelectorAll('#dashboard, #incidents, #incident-reporting, #chat, #responders, #transparency, #security')
                    .forEach(section => section.style.display = 'none');
                
                // Show selected section
                if (sectionId === 'dashboard') {
                    document.getElementById('dashboard').style.display = 'block';
                } else if (sectionId === 'incidents') {
                    document.getElementById('incidents').style.display = 'block';
                    if (!threatMap) {
                        setTimeout(initializeThreatMap, 100);
                    }
                } else {
                    document.getElementById(sectionId).style.display = 'block';
                    
                    // Initialize specific features when section is shown
                    if (sectionId === 'incident-reporting' && !locationMap) {
                        setTimeout(initializeLocationMap, 100);
                    }
                }
                
                currentSection = sectionId;
                
                // Log section view for audit trail
                addAuditEntry(`Viewed ${getSectionName(sectionId)}`);
            }

            function getSectionName(sectionId) {
                const names = {
                    'dashboard': 'Dashboard',
                    'incidents': 'Safety Threat Map',
                    'incident-reporting': 'Incident Reporting',
                    'chat': 'Community Chat',
                    'responders': 'Responder Network',
                    'transparency': 'Transparency Dashboard',
                    'security': 'Security & Privacy'
                };
                return names[sectionId] || sectionId;
            }

            function initializeThreatMap() {
                // Initialize the threat map visualization
                threatMap = L.map('heatmap-visualization').setView([-26.2041, 28.0473], 13);
            
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(threatMap);
            
                // Add sample incidents to the map
                incidentReports.forEach(incident => {
                    addIncidentToMap(incident);
                });
            }

            function initializeLocationMap() {
                // Initialize the map for location selection
                locationMap = L.map('incident-location-map').setView([-26.2041, 28.0473], 13);
            
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(locationMap);
            
                // Add click event to select location
                locationMap.on('click', function(e) {
                    if (selectedLocation) {
                        locationMap.removeLayer(selectedLocation);
                    }
                    
                    selectedLocation = L.marker(e.latlng).addTo(locationMap)
                        .bindPopup('Incident location')
                        .openPopup();
                });
            }

            function addIncidentToMap(incident) {
                // Determine color based on severity
                let color;
                switch(incident.severity) {
                    case 'low': color = '#4CAF50'; break;
                    case 'moderate': color = '#FFC107'; break;
                    case 'high': color = '#FF9800'; break;
                    case 'very-high': color = '#F44336'; break;
                    default: color = '#FF9800';
                }
                
                // Create custom icon
                const icon = L.divIcon({
                    className: 'incident-marker',
                    html: `<div style="background-color: ${color}; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 10px rgba(0,0,0,0.5);"></div>`,
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });
                
                // Add marker to map
                const marker = L.marker([incident.lat, incident.lng], {icon: icon})
                    .addTo(threatMap)
                    .bindPopup(`
                        <strong>${incident.type.replace(/\b\w/g, l => l.toUpperCase())}</strong><br>
                        Date: ${incident.date}<br>
                        Time: ${incident.time}<br>
                        Severity: ${incident.severity.replace('-', ' ').toUpperCase()}<br>
                        ${incident.description ? `Details: ${incident.description}` : ''}
                    `);
                
                mapMarkers.push(marker);
            }

            function handleIncidentReport(e) {
                e.preventDefault();
                
                // Check if consent for data storage is given
                if (!document.getElementById('consent-storage').checked) {
                    showNotification('You must consent to data storage to submit a report. Your data will be stored securely for 30 days only.', 'error');
                    return;
                }
                
                // Check if location is selected
                if (!selectedLocation) {
                    showNotification('Please select a location on the map for the incident.', 'error');
                    return;
                }
                
                const formData = {
                    id: incidentReports.length + 1,
                    type: document.getElementById('incident-type').value,
                    date: document.getElementById('incident-date').value,
                    time: document.getElementById('incident-time').value,
                    description: document.getElementById('incident-description').value,
                    location: selectedLocation.getLatLng(),
                    severity: document.getElementById('incident-type').value === 'harassment' || 
                              document.getElementById('incident-type').value === 'catcalling' ? 'high' : 'moderate',
                    consent: {
                        anonymous: document.getElementById('consent-anonymous').checked,
                        aggregate: document.getElementById('consent-aggregate').checked,
                        contact: document.getElementById('consent-contact').checked
                    },
                    timestamp: new Date().toISOString()
                };
                
                // Add to incident reports
                incidentReports.push(formData);
                
                // Add to threat map if it's initialized
                if (threatMap) {
                    addIncidentToMap(formData);
                }
                
                // Show success message
                showNotification('Thank you for your report. This information helps make our community safer for everyone.');
                
                // Reset form
                document.getElementById('report-form').reset();
                if (selectedLocation) {
                    locationMap.removeLayer(selectedLocation);
                    selectedLocation = null;
                }
                
                // Update dashboard metrics
                updateDashboardMetrics();
                
                // Log for audit trail
                addAuditEntry('Submitted incident report', `Type: ${formData.type}, Anonymous: ${formData.consent.anonymous}`);
                
                // Show how data leads to action
                showDataImpactMessage();
            }

            function updateDashboardMetrics() {
                document.getElementById('recent-incidents').textContent = incidentReports.length;
                document.getElementById('active-responders').textContent = responders.filter(r => r.availability.includes('24/7')).length;
                
                // Simulate random online users
                onlineUsers = 12 + Math.floor(Math.random() * 10);
                document.getElementById('online-count').textContent = `${onlineUsers} online`;
                document.getElementById('community-members').textContent = 142 + Math.floor(Math.random() * 20);
            }

            function showNotification(message, type = 'success') {
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.style.background = type === 'error' ? 'var(--danger)' : 'var(--success)';
                
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 'check-circle'}"></i>
                        <div>${message}</div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 5 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOutDown 0.3s ease';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 5000);
            }

            function showDataImpactMessage() {
                const impactMessages = [
                    "Your report has been added to community safety data that will be shared with local authorities to improve street lighting.",
                    "This information helps community patrols focus their efforts where they're needed most.",
                    "Your anonymous report contributes to making public spaces safer for everyone."
                ];
                
                const randomMessage = impactMessages[Math.floor(Math.random() * impactMessages.length)];
                
                // Create impact notification
                const notification = document.createElement('div');
                notification.className = 'notification';
                notification.style.background = 'var(--success)';
                
                notification.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-chart-line"></i>
                        <div>
                            <strong>Data Driving Change</strong>
                            <div style="font-size: 0.9rem; margin-top: 5px;">${randomMessage}</div>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // Remove after 6 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOutDown 0.3s ease';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 6000);
            }

            function loadChatMessages() {
                const container = document.getElementById('chat-messages');
                container.innerHTML = '';
                
                // Add sample messages
                chatMessages = [...sampleChatMessages];
                
                chatMessages.forEach(msg => {
                    const messageEl = document.createElement('div');
                    messageEl.className = `message ${msg.anonymous ? 'anonymous' : 'user'}`;
                    
                    messageEl.innerHTML = `
                        <div class="message-text">${msg.message}</div>
                        <div class="message-meta">
                            ${msg.user}  ${formatTime(msg.timestamp)}
                        </div>
                    `;
                    
                    container.appendChild(messageEl);
                });
                
                // Scroll to bottom
                container.scrollTop = container.scrollHeight;
            }

            function sendChatMessage() {
                const input = document.getElementById('chat-input');
                const messageText = input.value.trim();
                const isAnonymous = document.getElementById('anonymous-chat').checked;
                
                if (!messageText) return;
                
                // Create new message
                const newMessage = {
                    id: chatMessages.length + 1,
                    user: isAnonymous ? 'Community Member' : 'You',
                    message: messageText,
                    timestamp: new Date(),
                    anonymous: isAnonymous
                };
                
                // Add to messages
                chatMessages.push(newMessage);
                
                // Update UI
                const container = document.getElementById('chat-messages');
                const messageEl = document.createElement('div');
                messageEl.className = `message ${isAnonymous ? 'anonymous' : 'user'}`;
                
                messageEl.innerHTML = `
                    <div class="message-text">${messageText}</div>
                    <div class="message-meta">
                        ${newMessage.user}  ${formatTime(newMessage.timestamp)}
                    </div>
                `;
                
                container.appendChild(messageEl);
                
                // Clear input
                input.value = '';
                
                // Scroll to bottom
                container.scrollTop = container.scrollHeight;
                
                // Log for audit trail
                addAuditEntry('Sent chat message', `Anonymous: ${isAnonymous}, Length: ${messageText.length}`);
                
                // Simulate community response
                setTimeout(() => {
                    const responses = [
                        "Thanks for sharing that information!",
                        "I've noticed that too in my area.",
                        "That's helpful to know, thank you.",
                        "I'll keep an eye out for that."
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const responseMessage = {
                        id: chatMessages.length + 1,
                        user: 'Community Member',
                        message: randomResponse,
                        timestamp: new Date(),
                        anonymous: true
                    };
                    
                    chatMessages.push(responseMessage);
                    
                    const responseEl = document.createElement('div');
                    responseEl.className = 'message anonymous';
                    
                    responseEl.innerHTML = `
                        <div class="message-text">${randomResponse}</div>
                        <div class="message-meta">
                            Community Member  ${formatTime(responseMessage.timestamp)}
                        </div>
                    `;
                    
                    container.appendChild(responseEl);
                    container.scrollTop = container.scrollHeight;
                }, 2000);
            }

            function formatTime(date) {
                return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            }

            function loadResponders() {
                const grid = document.getElementById('responders-grid');
                grid.innerHTML = '';

                responders.forEach(responder => {
                    const card = document.createElement('div');
                    card.className = 'responder-card';
                    
                    card.innerHTML = `
                        <div class="responder-avatar">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <h4>${responder.name}</h4>
                        <div class="responder-badge">Verified & Trained</div>
                        <p><strong>Service:</strong> ${responder.type.replace('-', ' ').toUpperCase()}</p>
                        <p><strong>Area:</strong> ${responder.area}</p>
                        <p><strong>Available:</strong> ${responder.availability}</p>
                        <p><strong>Response Time:</strong> ${responder.responseTime}</p>
                        <div style="margin-top: 15px;">
                            <button class="btn-feature" onclick="openResponderModal(${responder.id})" style="background: var(--responders);">
                                <i class="fas fa-envelope"></i> Contact
                            </button>
                        </div>
                    `;
                    
                    grid.appendChild(card);
                });
            }

            function loadAuditTrail() {
                const log = document.getElementById('audit-log');
                
                // Sample audit entries
                auditTrail = [
                    { action: 'App installed', timestamp: new Date(Date.now() - 86400000).toISOString(), details: 'SafeSpace Studio installed on device' },
                    { action: 'Privacy policy viewed', timestamp: new Date(Date.now() - 43200000).toISOString(), details: 'User reviewed privacy guarantees' },
                    { action: 'Location access granted', timestamp: new Date(Date.now() - 21600000).toISOString(), details: 'Temporary location access for safety features' },
                    { action: 'Incident report submitted', timestamp: new Date(Date.now() - 7200000).toISOString(), details: 'Anonymous safety concern reported' }
                ];
                
                log.innerHTML = auditTrail.map(entry => `
                    <div class="audit-item">
                        <div>
                            <strong>${entry.action}</strong>
                            <div style="font-size: 0.8rem; color: var(--text-light);">${entry.details}</div>
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-light);">
                            ${new Date(entry.timestamp).toLocaleDateString()} ${new Date(entry.timestamp).toLocaleTimeString()}
                        </div>
                    </div>
                `).join('');
            }

            function addAuditEntry(action, details = '') {
                const entry = {
                    action,
                    timestamp: new Date().toISOString(),
                    details: details || action
                };
                
                auditTrail.unshift(entry);
                
                // Update the audit log if it's visible
                if (document.getElementById('security').style.display !== 'none') {
                    loadAuditTrail();
                }
            }

            function closeResponderModal() {
                document.getElementById('responder-modal').classList.remove('active');
            }

            // Global function for opening responder modal
            window.openResponderModal = function(responderId) {
                const responder = responders.find(r => r.id === responderId);
                if (!responder) return;
                
                document.getElementById('responder-modal-title').textContent = `Contact ${responder.name}`;
                document.getElementById('responder-modal-content').innerHTML = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="width: 80px; height: 80px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; margin: 0 auto 15px;">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <h4>${responder.name}</h4>
                        <div class="responder-badge" style="margin: 10px auto;">Verified & Trained</div>
                    </div>
                    
                    <div style="background: var(--bg); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <p><strong>Training:</strong> ${responder.training}</p>
                        <p><strong>Service Area:</strong> ${responder.area}</p>
                        <p><strong>Availability:</strong> ${responder.availability}</p>
                        <p><strong>Response Time:</strong> ${responder.responseTime}</p>
                    </div>
                    
                    <div style="text-align: center;">
                        <p><strong>Contact via Secure Message:</strong></p>
                        <button class="btn-feature" style="background: var(--responders); width: 100%; margin-bottom: 10px;" onclick="sendMessageToResponder(${responderId})">
                            <i class="fas fa-comment"></i> Send Secure Message
                        </button>
                        <p style="font-size: 0.8rem; color: var(--text-light); margin-top: 10px;">
                            All messages are encrypted and secure
                        </p>
                    </div>
                `;
                
                document.getElementById('responder-modal').classList.add('active');
                addAuditEntry(`Opened contact modal for ${responder.name}`);
            };

            // Global function for sending messages
            window.sendMessageToResponder = function(responderId) {
                const responder = responders.find(r => r.id === responderId);
                showNotification(`Secure message sent to ${responder.name}. They will respond during their availability hours.`);
                closeResponderModal();
                addAuditEntry(`Sent secure message to ${responder.name}`);
            };

            // Initialize the app
            console.log('Community Safety Platform Ready');
        });
    </script>
</body>
</html>